const canvas=document.getElementById("game-canvas"),generalButtons=document.getElementById("general-buttons"),modal=document.getElementById("modal"),modalTrophies=document.getElementById("modal-trophies"),trophyImage=document.getElementById("trophy"),canvasWidth=canvas.width,canvasHeight=canvas.height,inputs={colorPaddle1:document.getElementById("color-picker-p1"),colorPaddle2:document.getElementById("color-picker-p2"),gameSpeed:document.getElementById("game-speed"),pointsToWin:document.getElementById("points-to-win"),paddleSize:document.getElementById("paddle-size"),difficultyCPU:document.getElementById("difficulty-cpu"),obstacles:document.getElementById("obstacles"),crtMode:document.getElementById("crt-mode"),neonMode:document.getElementById("neon-mode"),sepiaMode:document.getElementById("sepia-mode"),blackAndWhiteMode:document.getElementById("black-and-white-mode")},sounds={goal:document.getElementById("goal"),victory:document.getElementById("victory"),lose:document.getElementById("lose"),bounce:document.getElementById("bounce"),bounceWall:document.getElementById("bounceWall"),buttonClick:document.getElementById("buttonClick"),countDown:document.getElementById("countdown"),music:document.getElementById("music"),trophyUnlocked:document.getElementById("trophy-unlocked")};let runGame,gamepad2Connected=!1,canvasContext;const trophiesVersionId=4;let trophies={firstGoal:{message:"Score your first goal",unlocked:!1,id:"goal-trophy"},firstWin:{message:"win a game",unlocked:!1,id:"win-trophy"},rallies:{message:"20 consecutive rallies",unlocked:!1,id:"rallies-trophy"},powerShot:{message:"perform a powershot",unlocked:!1,id:"powershot-trophy"},sliceShot:{message:"perform a sliceshot",unlocked:!1,id:"sliceshot-trophy"},miniPaddle:{message:"win game with mini paddle",unlocked:!1,id:"mini-paddle-trophy"},hardCPU:{message:"win against highest difficulty CPU",unlocked:!1,id:"highest-difficulty-trophy"},obstacles:{message:"win with maximum obstacles",unlocked:!1,id:"obstacles-trophy"},multiplayer:{message:"win multiplayer game",unlocked:!1,id:"multiplayer-trophy"},zeroGoals:{message:"win without conceding a goal",unlocked:!1,id:"zero-goals-trophy"},openSettings:{message:"open the settings",unlocked:!1,id:"settings-trophy"},openGithub:{message:"open my github link",unlocked:!1,id:"github-trophy"},blackAndWhite:{message:"play a game in black and white",unlocked:!1,id:"black-and-white-trophy"},sepia:{message:"play a game in sepia",unlocked:!1,id:"sepia-trophy"}};const gameStates={notStarted:"game not started yet",gameRunning:"game currently running",gameOver:"game over"},settings={gameState:gameStates.notStarted,isSinglePlayer:!0,difficultyCPU:6,pointsToWin:inputs.pointsToWin.value,gameSpeed:90,gameSpeedModifier:0,amountObstacles:0,countdownValue:3,tolerance:20,font:"48px retro",paddleHeight:parseInt(inputs.paddleSize.value),goalAnimationRunning:!1,isNeonMode:inputs.neonMode.checked},ball={x:395,y:300,speedX:5,speedY:0,directionX:1},paddle1={x:30,y:250,height:settings.paddleHeight,score:0,color:"#00ff00",collision:!1,gamePadIndex:0},paddle2={x:760,y:250,height:settings.paddleHeight,score:0,color:"#FFA500",collision:!1,gamePadIndex:1},obstacle1={x:canvasWidth/2-5,y:-450,width:10,height:100,collision:!1},obstacle2={x:canvasWidth/2-5,y:-750,width:10,height:100,collision:!1},obstacle3={x:canvasWidth/2-5,y:-1050,width:10,height:100,collision:!1},buttonsPressed={up:!1,down:!1,left:!1,right:!1,w:!1,a:!1,s:!1,d:!1,padUp:!1,padDown:!1,padLeft:!1,padRight:!1};window.addEventListener("keydown",e=>{[" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(e.key)&&e.preventDefault()},!1),window.addEventListener("gamepad1Connected",e=>{console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)}),window.addEventListener("gamepad2Connected",e=>{gamepad2Connected=!0,console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)}),inputs.colorPaddle1.addEventListener("change",()=>paddle1.color=inputs.colorPaddle1.value),inputs.colorPaddle2.addEventListener("change",()=>paddle2.color=inputs.colorPaddle2.value),inputs.gameSpeed.addEventListener("change",()=>settings.gameSpeed=parseInt(inputs.gameSpeed.value)),inputs.paddleSize.addEventListener("change",()=>{settings.paddleHeight=parseInt(inputs.paddleSize.value),paddle1.height=settings.paddleHeight,paddle2.height=settings.paddleHeight}),inputs.crtMode.addEventListener("change",()=>document.body.classList.toggle("crt")),inputs.neonMode.addEventListener("change",()=>{settings.isNeonMode=inputs.neonMode.checked,document.body.classList.toggle("neon-mode")}),inputs.sepiaMode.addEventListener("change",()=>{document.body.classList.toggle("sepia-mode"),document.body.classList.remove("black-and-white"),inputs.blackAndWhiteMode.checked=!1}),inputs.blackAndWhiteMode.addEventListener("change",()=>{document.body.classList.toggle("black-and-white"),document.body.classList.remove("sepia-mode"),inputs.sepiaMode.checked=!1}),inputs.difficultyCPU.addEventListener("change",()=>settings.difficultyCPU=parseInt(inputs.difficultyCPU.value)),inputs.pointsToWin.addEventListener("change",()=>{settings.pointsToWin=parseInt(inputs.pointsToWin.value),settings.pointsToWin<1&&(settings.pointsToWin=1)}),inputs.obstacles.addEventListener("change",()=>settings.amountObstacles=parseInt(inputs.obstacles.value)),window.onload=()=>{document.addEventListener("keydown",keyDownHandler,!1),document.addEventListener("keyup",keyUpHandler,!1)};const setFullscreen=()=>{playSound(sounds.buttonClick);const e=document.getElementById("fullscreen-button");document.fullscreenElement?document.exitFullscreen().then(()=>{e.setAttribute("data-fullscreen","inactive")}).catch(()=>{e.setAttribute("data-fullscreen","active")}):document.body.requestFullscreen().then(()=>{e.setAttribute("data-fullscreen","active")}).catch(()=>{e.setAttribute("data-fullscreen","inactive")})},openSettings=()=>{playSound(sounds.buttonClick),modal.showModal(),trophies.openSettings.unlocked||unlockTrophy(trophies.openSettings)},closeSettings=()=>{playSound(sounds.buttonClick),modal.close()},unlockGithubTrophy=()=>{trophies.openGithub.unlocked||unlockTrophy(trophies.openGithub)},openTrophies=()=>{settings.goalAnimationRunning||(settings.gameState===gameStates.gameRunning&&clearInterval(runGame),playSound(sounds.buttonClick),modalTrophies.showModal())},closeTrophies=()=>{playSound(sounds.buttonClick),modalTrophies.close(),clearInterval(runGame),settings.gameState===gameStates.gameRunning&&(runGame=setInterval(gameLoop,1e3/(settings.gameSpeed+settings.gameSpeedModifier)))},setCountdown=()=>{const e=setInterval(()=>{settings.countdownValue--,settings.countdownValue===0&&(clearInterval(e),settings.gameState=gameStates.gameRunning)},1e3)},startGame=e=>{playSound(sounds.buttonClick),playSound(sounds.countDown),requestAnimationFrame(drawEverything),setTimeout(()=>playSound(sounds.music),3e3),sounds.music.loop=!0,paddle1.y=canvasHeight/2-paddle1.height/2,paddle2.y=canvasHeight/2-paddle2.height/2,setCountdown(),settings.isSinglePlayer=e,canvas.style.display="block",canvasContext=canvas.getContext("2d"),settings.isNeonMode&&(canvasContext.shadowBlur=4,canvasContext.shadowColor="#55ffff99"),runGame=setInterval(gameLoop,1e3/(settings.gameSpeed+settings.gameSpeedModifier)),generalButtons.style.display="none"},gameLoop=()=>{setScore(),checkGameOver(),moveEverything(),collision(paddle2,buttonsPressed.up,buttonsPressed.down),collision(paddle1,buttonsPressed.w,buttonsPressed.s),collisionWithObstacle(),move1(),settings.isSinglePlayer?moveAI():move2()},moveEverything=()=>{if(settings.gameState!==gameStates.gameRunning)return;ball.x=ball.x+ball.speedX*ball.directionX,ball.y=ball.y+ball.speedY*2,(ball.x>=canvasWidth||ball.x<=0)&&(ball.directionX=ball.directionX*-1);const e=ball.y>=canvasHeight,t=ball.y<=0;(e||t)&&(ball.speedY=-ball.speedY,playSound(sounds.bounceWall)),e&&(ball.y=canvasHeight),t&&(ball.y=0)},move1=()=>{if(navigator.getGamepads()[0]!==null){move1Gamepad();return}buttonsPressed.w&&(paddle1.y-=8),paddle1.y<0&&(paddle1.y=0),buttonsPressed.s&&(paddle1.y+=6),paddle1.y>canvasHeight-paddle1.height&&(paddle1.y=canvasHeight-paddle1.height),buttonsPressed.d&&paddle1.x<canvasWidth/2.5&&(paddle1.x+=5),buttonsPressed.a&&paddle1.x>20&&(paddle1.x-=5)},move1Gamepad=()=>{buttonsPressed.padUp&&(paddle1.y-=8),paddle1.y<0&&(paddle1.y=0),buttonsPressed.padDown&&(paddle1.y+=6),paddle1.y>canvasHeight-paddle1.height&&(paddle1.y=canvasHeight-paddle1.height),buttonsPressed.padRight&&paddle1.x<canvasWidth/2.5&&(paddle1.x+=5),buttonsPressed.padLeft&&paddle1.x>20&&(paddle1.x-=5)},move2=()=>{const e=navigator.getGamepads()[0]!==null;buttonsPressed.down&&(paddle2.y=paddle2.y+8),paddle2.y>canvasHeight-paddle2.height&&(paddle2.y=canvasHeight-paddle2.height),buttonsPressed.up&&(paddle2.y=paddle2.y-6),paddle2.y<0&&(paddle2.y=0),buttonsPressed.right&&paddle2.x<canvasWidth-20&&(paddle2.x+=5),buttonsPressed.left&&paddle2.x>canvasWidth-canvasWidth/2.5&&(paddle2.x-=5)},moveAI=()=>{ball.speedX>0&&moveAItoBall(),paddle2.y<0&&(paddle2.y=0),paddle2.y>canvasHeight-paddle2.height&&(paddle2.y=canvasHeight-paddle2.height)},moveAItoBall=()=>{buttonsPressed.down=!1,buttonsPressed.up=!1,ball.y>paddle2.y+paddle2.height/2&&(paddle2.y+=settings.difficultyCPU,buttonsPressed.down=!0),ball.y<paddle2.y+paddle2.height/2&&(paddle2.y-=settings.difficultyCPU,buttonsPressed.up=!0)},resetAfterScore=()=>{if(settings.gameState===gameStates.gameOver){settings.goalAnimationRunning=!1;return}playSound(sounds.goal),setTimeout(()=>{settings.goalAnimationRunning=!1,runGame=setInterval(gameLoop,1e3/(settings.gameSpeed+settings.gameSpeedModifier)),settings.gameSpeedModifier=0,obstacle1.y=-450,obstacle2.y=-750,obstacle3.y=-1050,animationOpacity=0,ball.x=395,ball.y=300,paddle1.y=canvasHeight/2-paddle1.height/2,paddle1.x=30,paddle2.y=canvasHeight/2-paddle2.height/2,paddle2.x=760,ball.speedY=0;let e=ball.directionX<0;ball.directionX=0,setTimeout(()=>{ball.directionX=e?1:-1,ball.speedX=5},1e3)},2e3)},keyDownHandler=e=>{switch(e.key){case"w":{buttonsPressed.w=!0;break}case"a":{buttonsPressed.a=!0;break}case"d":{buttonsPressed.d=!0;break}case"s":{buttonsPressed.s=!0;break}case"ArrowUp":{buttonsPressed.up=!0;break}case"ArrowDown":{buttonsPressed.down=!0;break}case"ArrowLeft":{buttonsPressed.left=!0;break}case"ArrowRight":buttonsPressed.right=!0}},keyUpHandler=e=>{switch(e.key){case"w":{buttonsPressed.w=!1;break}case"a":{buttonsPressed.a=!1;break}case"d":{buttonsPressed.d=!1;break}case"s":{buttonsPressed.s=!1;break}case"ArrowUp":{buttonsPressed.up=!1;break}case"ArrowDown":{buttonsPressed.down=!1;break}case"ArrowLeft":{buttonsPressed.left=!1;break}case"ArrowRight":buttonsPressed.right=!1}},drawScore=()=>{canvasContext.font=settings.font,canvasContext.fillStyle="white",drawCenteredText(paddle1.score,canvasWidth/4,60),drawCenteredText(paddle2.score,canvasWidth*3/4,60)},drawCenteredText=(e,t,n)=>{const o=canvasContext.measureText(e).width,s=t-o/2;canvasContext.fillText(e,s,n)},drawVictoryMessage=()=>{const e=paddle1.score>paddle2.score;canvasContext.fillStyle=e?"green":"red",canvasContext.fillRect(0,0,canvasWidth/2,canvasHeight),canvasContext.fillStyle=e?"red":"green",canvasContext.fillRect(canvasWidth/2,0,canvasWidth/2,canvasHeight),drawScore(),trophyImage.classList.remove("trophy-hidden"),trophyImage.classList.add(e?"trophy-p1":"trophy-p2");const t=e?"Win":"Lose",n=e?"Lose":"Win";canvasContext.fillStyle="white",drawCenteredText(t,canvasWidth/4,350),drawCenteredText(n,canvasWidth*3/4,350)},playSound=e=>{e.play()},setScore=()=>{if(settings.gameState===gameStates.gameOver)return;const e=ball.x>=canvasWidth,t=ball.x<=0;(e||t)&&(settings.goalAnimationRunning=!0,resetAfterScore(),clearInterval(runGame),checkGameOver()),e&&(paddle1.score++,trophies.firstGoal.unlocked||unlockTrophy(trophies.firstGoal)),t&&paddle2.score++},fadeOutMusic=()=>{const e=setInterval(()=>{(sounds.music.volume<=.2||sounds.music.playbackRate<.5)&&clearInterval(e),sounds.music.volume-=.1,sounds.music.playbackRate-=.1},100)},checkGameOver=()=>{if(settings.gameState===gameStates.gameOver)return;const e=paddle1.score>=settings.pointsToWin,t=paddle2.score>=settings.pointsToWin;(e||t)&&(settings.gameState=gameStates.gameOver,settings.goalAnimationRunning=!1,clearInterval(runGame),fadeOutMusic(),handleAchievedTrophies(e),t&&settings.isSinglePlayer?playSound(sounds.lose):playSound(sounds.victory),setTimeout(()=>document.getElementById("restart-button").style.display="block",2e3))},checkTrophiesInLocalStorage=()=>{const e=localStorage.getItem("trophies-version-id");if(!e||JSON.parse(e)!==trophiesVersionId)return;const t=localStorage.getItem("trophies-pong");t&&(trophies=JSON.parse(t),Object.entries(trophies).forEach(([n,o])=>{if(o.unlocked){const s=document.getElementById(o.id);if(!s)return;s.classList.add("unlocked")}}))};checkTrophiesInLocalStorage();const handleAchievedTrophies=e=>{const t=[];e&&!trophies.firstWin.unlocked&&(trophies.firstWin.unlocked=!0,t.push(trophies.firstWin)),e&&!trophies.zeroGoals.unlocked&&paddle2.score===0&&(trophies.zeroGoals.unlocked=!0,t.push(trophies.zeroGoals)),e&&settings.amountObstacles===parseInt(inputs.obstacles.max)&&!trophies.obstacles.unlocked&&(trophies.obstacles.unlocked=!0,t.push(trophies.obstacles)),e&&settings.difficultyCPU>=9&&!trophies.hardCPU.unlocked&&(trophies.hardCPU.unlocked=!0,t.push(trophies.hardCPU)),e&&!settings.isSinglePlayer&&!trophies.multiplayer.unlocked&&(trophies.multiplayer.unlocked=!0,t.push(trophies.multiplayer)),e&&settings.paddleHeight<=50&&!trophies.miniPaddle.unlocked&&(trophies.miniPaddle.unlocked=!0,t.push(trophies.miniPaddle)),inputs.blackAndWhiteMode.checked&&!trophies.blackAndWhite.unlocked&&(trophies.blackAndWhite.unlocked=!0,t.push(trophies.blackAndWhite)),inputs.sepiaMode.checked&&!trophies.sepia.unlocked&&(trophies.sepia.unlocked=!0,t.push(trophies.sepia)),localStorage.setItem("trophies-version-id",JSON.stringify(trophiesVersionId)),localStorage.setItem("trophies-pong",JSON.stringify(trophies)),t.forEach((n,o)=>{setTimeout(()=>{showTrophyToast(n)},o*1e3)})},showTrophyToast=e=>{playSound(sounds.trophyUnlocked);const t=document.createElement("div");t.innerHTML=`
        <img class='trophy-toast' src='images/pong/trophy.gif' alt='trophy-icon' />
        <span>${e.message}</span> 
      `,t.classList.add("toast"),document.getElementById("toasts").appendChild(t),setTimeout(()=>{t.remove()},6e3),checkTrophiesInLocalStorage()},unlockTrophy=e=>{e.unlocked=!0,localStorage.setItem("trophies-version-id",JSON.stringify(trophiesVersionId)),localStorage.setItem("trophies-pong",JSON.stringify(trophies)),showTrophyToast(e)},collision=(e,t,n)=>{const o=typeof navigator<"u"&&typeof navigator.getGamepads=="function"&&navigator.getGamepads()[e.gamePadIndex]!==null,s=n||o&&navigator?.getGamepads?.()[e.gamePadIndex]?.buttons?.[13]?.pressed,a=t||o&&navigator?.getGamepads?.()[e.gamePadIndex]?.buttons?.[12]?.pressed,i=buttonsPressed.d||o&&navigator?.getGamepads?.()[e.gamePadIndex]?.buttons?.[15]?.pressed,c=ball.x>e.x-5&&ball.x<e.x+15,d=ball.y>=e.y-settings.tolerance&&ball.y<e.y-1+e.height+settings.tolerance;if(c&&d&&!e.collision){obstacle1.collision=!1,obstacle2.collision=!1,obstacle3.collision=!1;const l=ball.x>canvasWidth/2;paddle1.collision=!l,paddle2.collision=l,ball.directionX=-ball.directionX,(paddle1.collision||paddle2.collision)&&(settings.gameSpeedModifier+=1,settings.gameSpeedModifier>=20&&!trophies.rallies.unlocked&&unlockTrophy(trophies.rallies),settings.gameSpeedModifier%10===0&&(clearInterval(runGame),runGame=setInterval(gameLoop,1e3/(settings.gameSpeed+settings.gameSpeedModifier)))),paddle1.collision&&(ball.x+=i?5:0,ball.speedX=i?10:5,animateCollisionP1(),!trophies.powerShot.unlocked&&i&&unlockTrophy(trophies.powerShot)),paddle2.collision&&(ball.x-=buttonsPressed.left?5:0,ball.speedX=buttonsPressed.left?10:5,animateCollisionP2()),ball.speedY===0&&(ball.speedY=2),s&&ball.speedY<0&&(ball.speedY-=1,trophies.sliceShot.unlocked||unlockTrophy(trophies.sliceShot)),a&&ball.speedY>0&&(ball.speedY+=1,trophies.sliceShot.unlocked||unlockTrophy(trophies.sliceShot)),buttonsPressed.left&&paddle2.collision?playSound(sounds.bounce,16):playSound(sounds.bounce,.5),i&&paddle1.collision?playSound(sounds.bounce,16):playSound(sounds.bounce,.5)}},collisionWithObstacle=()=>{const e=settings.amountObstacles>=1,t=settings.amountObstacles>=2,n=settings.amountObstacles>=3;if(!e)return;const o=ball.x>obstacle1.x-5&&ball.x<obstacle1.x+15,s=ball.y>=obstacle1.y-settings.tolerance&&ball.y<obstacle1.y-1+obstacle1.height+settings.tolerance||t&&ball.y>=obstacle2.y-settings.tolerance&&ball.y<obstacle2.y-1+obstacle1.height+settings.tolerance||n&&ball.y>=obstacle3.y-settings.tolerance&&ball.y<obstacle3.y-1+obstacle1.height+settings.tolerance,a=obstacle1.collision||obstacle2.collision||obstacle3.collision;o&&s&&!a&&(playSound(sounds.bounceWall),ball.directionX=-ball.directionX,obstacle1.collision=!0,obstacle2.collision=!0,obstacle3.collision=!0,paddle1.collision=!1,paddle2.collision=!1)},animateCollisionP1=()=>{paddle1.x-=6,setTimeout(()=>paddle1.x+=6,50),setTimeout(()=>paddle1.x-=3,100),setTimeout(()=>paddle1.x+=3,150),setTimeout(()=>paddle1.x-=1,200),setTimeout(()=>paddle1.x+=1,250)},animateCollisionP2=()=>{paddle2.x+=6,setTimeout(()=>paddle2.x-=6,50),setTimeout(()=>paddle2.x+=3,100),setTimeout(()=>paddle2.x-=3,150),setTimeout(()=>paddle2.x+=1,200),setTimeout(()=>paddle2.x-=1,250)};let backgroundOpacity=0,textOpacity=.5;const drawGoalAnimation=()=>{canvasContext.fillStyle=`rgba(255,0,0,${backgroundOpacity})`,canvasContext.fillRect(0,0,canvasWidth,canvasHeight),backgroundOpacity+=.2,drawLetter(letterG,110,canvasHeight/2-40,textOpacity),drawLetter(letterO,230,canvasHeight/2-40,textOpacity),drawLetter(letterA,350,canvasHeight/2-40,textOpacity),drawLetter(letterL,470,canvasHeight/2-40,textOpacity),drawLetter(exclamationMark,580,canvasHeight/2-40,textOpacity),textOpacity===.5?textOpacity=1:textOpacity=.5},drawObstacles=()=>{const e=settings.amountObstacles>=1,t=settings.amountObstacles>=2,n=settings.amountObstacles>=3;e&&(roundedRect(obstacle1.x,obstacle1.y,obstacle1.width,obstacle1.height,4,"#ff0000ee"),t&&roundedRect(obstacle2.x,obstacle2.y,obstacle2.width,obstacle2.height,4,"#ff0000ee"),n&&roundedRect(obstacle3.x,obstacle3.y,obstacle3.width,obstacle3.height,4,"#ff0000ee"),obstacle1.y++,obstacle2.y++,obstacle3.y++,obstacle1.y>canvasHeight+100&&(obstacle1.y=-200),obstacle2.y>canvasHeight+100&&(obstacle2.y=-200),obstacle3.y>canvasHeight+100&&(obstacle3.y=-200))},drawPlayingField=()=>{roundedRect(2,2,canvasWidth-4,canvasHeight-4,4,"#000000"),canvasContext.fillStyle="rgba(255,0,0,0.4)",canvasContext.fillRect(canvasWidth/2,0,1,canvasHeight)},drawBallsAndPaddles=()=>{roundedRect(ball.x,ball.y,10,10,4,"white"),roundedRect(paddle1.x,paddle1.y,10,paddle1.height,4,paddle1.color+"dd"),roundedRect(paddle2.x,paddle2.y,10,paddle2.height,4,paddle2.color+"dd")},drawCountDown=()=>{canvasContext.fillStyle="white",settings.countdownValue>0&&canvasContext.fillText(settings.countdownValue,canvasWidth/2-20,canvasHeight/2-40)},drawEverything=()=>{canvasContext.clearRect(0,0,canvasWidth,canvasHeight),settings.goalAnimationRunning||(drawPlayingField(),settings.gameState!==gameStates.gameOver&&(drawObstacles(),drawBallsAndPaddles()),drawCountDown(),backgroundOpacity=0,textOpacity=.5),drawScore(),settings.gameState===gameStates.gameOver&&drawVictoryMessage(),settings.goalAnimationRunning&&settings.gameState!==gameStates.gameOver&&drawGoalAnimation(),requestAnimationFrame(drawEverything)};let volume=1;const setVolume=e=>{e===null||e<0||e>5?volume=1:volume=Number(e)*2/10,sessionStorage.setItem("volume",e),Array.from(document.getElementsByClassName("volume-item")).forEach(o=>{o.innerHTML=o.dataset.value>e?"&#9645;":"&#11036;"}),document.querySelectorAll("audio").forEach(o=>o.volume=volume)},volumeFromSessionStorage=window.sessionStorage.getItem("volume");volumeFromSessionStorage&&setVolume(parseFloat(volumeFromSessionStorage));const roundedRect=(e,t,n,o,s,a)=>{canvasContext.save(),settings.isNeonMode&&(canvasContext.shadowColor=a,a==="#000000"&&(canvasContext.shadowColor="#ffffff"),canvasContext.shadowBlur=8,canvasContext.shadowOffsetX=0,canvasContext.shadowOffsetY=0),canvasContext.fillStyle=a,canvasContext.strokeStyle=a,canvasContext.lineWidth=2,canvasContext.beginPath(),canvasContext.roundRect(e,t,n,o,s),canvasContext.fill(),canvasContext.stroke(),canvasContext.closePath(),canvasContext.restore()},tileWidth=20,tileHeight=20,letterG=[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,0],[1,0,1,1,1],[0,1,1,1,0]],letterO=[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],letterA=[[0,1,1,1,0],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]],letterL=[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]],exclamationMark=[[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,0,0,0,0],[1,0,1,0,1]],drawLetter=(e,t,n,o)=>{for(let s=0;s<e.length;s++)for(let a=0;a<e[0].length;a++)e[s][a]===1&&(canvasContext.fillStyle=`rgba(255,255,255,${o}`,canvasContext.fillRect(t+a*tileWidth,n+s*tileHeight,tileWidth,tileHeight))};
