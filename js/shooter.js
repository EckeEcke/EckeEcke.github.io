const canvas=document.getElementById("game-canvas"),canvasContext=canvas.getContext("2d"),nameInput=document.getElementById("name-input");canvasContext.font="24px retro";const versionNumber="3.0.0",initStars=()=>{const i=document.getElementById("stars-container");for(let e=0;e<100;e++){const s=document.createElement("div");s.className="star";const t=Math.random()*100,h=Math.random()*100,o=Math.random()*3+2,a=Math.random()*5,n=Math.random()*2+1;Object.assign(s.style,{left:`${t}%`,top:`${h}%`,width:`${n}px`,height:`${n}px`,animationDuration:`${o}s`,animationDelay:`${a}s`}),i.appendChild(s)}};document.addEventListener("DOMContentLoaded",initStars);const imageSources={playerShip:"./images/shooter/player-ship.png",playerShot:"./images/shooter/player-shot.png",longShot:"./images/shooter/longshot.png",wideShot:"./images/shooter/wideshot.png",wideAndlongShot:"./images/shooter/wide-and-longshot.png",snakeHead:"./images/shooter/snake-head-new.png",snakeBody:"./images/shooter/snake-body-new.png",enemyShip:"./images/shooter/enemy-ship-new.png",enemyShot:"./images/shooter/enemy-shot.png",asteroid:"./images/shooter/asteroid.png",explosion:"./images/shooter/explosion.png",bossStructure:"./images/shooter/boss-structure.png",background:"./images/shooter/background.jpg",backgroundLoop:"./images/shooter/background-loop.jpg",astronaut:"./images/shooter/astronaut2.png"},images={playerShip:new Image,playerShot:new Image,longShot:new Image,wideShot:new Image,wideAndLongShot:new Image,snakeHead:new Image,snakeBody:new Image,enemyShip:new Image,enemyShot:new Image,asteroid:new Image,explosion:new Image,bossStructure:new Image,background:new Image,backgroundLoop1:new Image,backgroundLoop2:new Image,astronaut:new Image};function loadImages(){images.snakeHead.onload=()=>game.gameLoaded+=5,images.snakeBody.onload=()=>game.gameLoaded+=5,images.enemyShip.onload=()=>game.gameLoaded+=5,images.bossStructure.onload=()=>game.gameLoaded+=5,images.background.onload=()=>game.gameLoaded+=5,images.playerShip.onload=()=>game.gameLoaded+=5,images.explosion.onload=()=>game.gameLoaded+=5,images.asteroid.onload=()=>game.gameLoaded+=3,images.astronaut.onload=()=>game.gameLoaded+=2,images.snakeHead.src=imageSources.snakeHead,images.snakeBody.src=imageSources.snakeBody,images.enemyShip.src=imageSources.enemyShip,images.enemyShot.src=imageSources.enemyShot,images.bossStructure.src=imageSources.bossStructure,images.background.src=imageSources.background,images.backgroundLoop1.src=imageSources.backgroundLoop,images.backgroundLoop2.src=imageSources.backgroundLoop,images.playerShip.src=imageSources.playerShip,images.playerShot.src=imageSources.playerShot,images.longShot.src=imageSources.longShot,images.wideShot.src=imageSources.wideShot,images.wideAndLongShot.src=imageSources.wideAndlongShot,images.explosion.src=imageSources.explosion,images.asteroid.src=imageSources.asteroid,images.astronaut.src=imageSources.astronaut}const soundSources={laserEnemy:"./sounds/shooter/laser-enemy.wav",laser:"./sounds/shooter/laser.wav",laser2:"./sounds/shooter/laser2.wav",laser3:"./sounds/shooter/laser3.wav",powerUp:"./sounds/shooter/shooter-power-up.wav",hitSound:"./sounds/shooter/hit2.wav",bossHitSound:"./sounds/shooter/boss-hit2.wav",bossAlert:"./sounds/shooter/boss-alert.wav",spaceshipSound:"./sounds/shooter/spaceship-rising.wav",loseSound:"./sounds/shooter/lose-shooter.wav",gameMusic:"./sounds/shooter/space-shooter-music.mp3",gameMusic2:"./sounds/shooter/music2.mp3",gameMusic3:"./sounds/shooter/music3.mp3",shieldUp:"./sounds/shooter/shield-up.wav",shieldDown:"./sounds/shooter/shield-down.wav",explosion:"./sounds/shooter/explosion.wav",explosion2:"./sounds/shooter/explosion2.wav",thankYou:"./sounds/shooter/thank-you.mp3",teleport:"./sounds/shooter/teleport.wav",credits:"./sounds/shooter/credits.mp3"},sounds={laserEnemy:void 0,laser:void 0,laser2:void 0,laser3:void 0,powerUp:void 0,hitSound:void 0,bossHitSound:void 0,bossAlert:void 0,spaceshipSound:void 0,loseSound:void 0,gameMusic:void 0,gameMusic2:void 0,gameMusic3:void 0,shieldUp:void 0,shieldDown:void 0,explosion:void 0,explosion2:void 0,thankYou:void 0,teleport:void 0,credits:void 0};function loadSounds(){sounds.laserEnemy=new Audio(soundSources.laserEnemy),sounds.laserEnemy.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("laserEnemy",sounds.laserEnemy,20),sounds.laser=new Audio(soundSources.laser),sounds.laser.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("laser",sounds.laser,10),sounds.laser2=new Audio(soundSources.laser2),sounds.laser2.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("laser2",sounds.laser2,10),sounds.laser3=new Audio(soundSources.laser3),sounds.laser3.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("laser3",sounds.laser3,10),sounds.powerUp=new Audio(soundSources.powerUp),sounds.powerUp.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("powerUp",sounds.powerUp,6),sounds.hitSound=new Audio(soundSources.hitSound),sounds.hitSound.onloadeddata=()=>game.gameLoaded+=3,initAudioPool("hitSound",sounds.hitSound,20),sounds.bossHitSound=new Audio(soundSources.bossHitSound),sounds.bossHitSound.onloadeddata=()=>game.gameLoaded+=1,initAudioPool("bossHitSound",sounds.bossHitSound,10),sounds.bossAlert=new Audio(soundSources.bossAlert),sounds.bossAlert.onloadeddata=()=>game.gameLoaded+=1,initAudioPool("bossAlert",sounds.bossAlert,1),sounds.spaceshipSound=new Audio(soundSources.spaceshipSound),sounds.spaceshipSound.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("spaceshipSound",sounds.spaceshipSound,1),sounds.loseSound=new Audio(soundSources.loseSound),sounds.loseSound.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("loseSound",sounds.loseSound,1),sounds.gameMusic=new Audio(soundSources.gameMusic),sounds.gameMusic.onloadeddata=()=>game.gameLoaded+=3,sounds.gameMusic.loop=!0,sounds.gameMusic2=new Audio(soundSources.gameMusic2),sounds.gameMusic2.onloadeddata=()=>game.gameLoaded+=1,sounds.gameMusic2.loop=!0,sounds.gameMusic3=new Audio(soundSources.gameMusic3),sounds.gameMusic3.onloadeddata=()=>game.gameLoaded+=1,sounds.gameMusic3.loop=!0,sounds.shieldUp=new Audio(soundSources.shieldUp),sounds.shieldUp.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("shieldUp",sounds.shieldUp,3),sounds.shieldDown=new Audio(soundSources.shieldDown),sounds.shieldDown.onloadeddata=()=>game.gameLoaded+=5,initAudioPool("shieldDown",sounds.shieldDown,3),sounds.explosion=new Audio(soundSources.explosion),sounds.explosion.onloadeddata=()=>game.gameLoaded+=1,initAudioPool("explosion",sounds.explosion,30),sounds.explosion2=new Audio(soundSources.explosion2),sounds.explosion2.onloadeddata=()=>game.gameLoaded+=1,initAudioPool("explosion2",sounds.explosion2,30),sounds.thankYou=new Audio(soundSources.thankYou),sounds.thankYou.onloadeddata=()=>game.gameLoaded+=1,initAudioPool("thankYou",sounds.thankYou,10),sounds.teleport=new Audio(soundSources.teleport),sounds.teleport.onloadeddata=()=>game.gameLoaded+=1,initAudioPool("teleport",sounds.teleport,8),sounds.credits=new Audio(soundSources.credits),sounds.credits.onloadeddata=()=>game.gameLoaded+=1}const audioPool={},initAudioPool=(i,e,s=10)=>{audioPool[i]={samples:[],currentIndex:0};for(let t=0;t<s;t++){const h=e.cloneNode();audioPool[i].samples.push(h)}};function playSound(i){const e=audioPool[i];if(!e){const t=sounds[i];if(!t)return;t.play();return}const s=e.samples[e.currentIndex];s&&(s.pause(),s.currentTime=0,s.play(),e.currentIndex=(e.currentIndex+1)%e.samples.length)}function playMusic(i){i.pause(),i.currentTime=0,i.play()}class Player{constructor(){this.height=64,this.width=40,this.x=canvas.width/2-this.width/2,this.y=canvas.height-this.height,this.killed=!1,this.coolDownPlayer=400,this.isShotCoolDown=!1,this.shots=[],this.hasShield=!1,this.isInvincible=!1,this.hasWideShot=!1,this.hasLongShot=!1}setActiveShots(){for(let e=this.shots.length-1;e>=0;e--)this.shots[e].isActive||this.shots.splice(e,1)}resetShots(){this.shots=[]}draw(){!this.hasShield&&this.isInvincible?canvasContext.filter="hue-rotate(180deg) brightness(1.2) saturate(1.5)":canvasContext.filter="none",this.killed?canvasContext.drawImage(images.explosion,this.x+(this.height-this.width)/2,this.y,this.height,this.height):canvasContext.drawImage(images.playerShip,this.x,this.y,this.width,this.height),this.hasShield&&this.drawShield()}drawShield(){const s=this.x+this.width/2,t=this.y+this.height/2;canvasContext.beginPath(),canvasContext.arc(s,t,50,0,Math.PI*2);const h=canvasContext.createRadialGradient(s,t,0,s,t,50);h.addColorStop(0,"rgba(94, 234, 212, 0.3)"),h.addColorStop(1,"rgba(0, 0, 255, 0.3)"),canvasContext.fillStyle=h,canvasContext.fill()}move(){let e=navigator.getGamepads()[0]!==null;(buttonsPressed.a||e&&navigator.getGamepads()[0].buttons[14].pressed)&&(this.x-=3),this.x<0&&(this.x=0),(buttonsPressed.d||e&&navigator.getGamepads()[0].buttons[15].pressed)&&(this.x+=3),this.x>canvas.width-this.width&&(this.x=canvas.width-this.width)}moveTouch(){touchControls.active&&(this.x>touchControls.x&&(this.x-=4),this.x<touchControls.x&&(this.x+=4))}shoot(){if(this.isShotCoolDown)return;const e=navigator.getGamepads()[0]!==null;if(buttonsPressed.w||e&&navigator.getGamepads()[0].buttons[0].pressed||touchControls.active){this.isShotCoolDown=!0,setTimeout(()=>this.isShotCoolDown=!1,this.coolDownPlayer);const s=new Shot(this.hasWideShot,this.hasLongShot);this.shots.push(s),s.playLaserSound()}}losePowerUps(){playSound("shieldDown"),this.hasShield=!1,this.hasWideShot=!1,this.hasLongShot=!1,createExplosion(this.x+this.width/2,this.y+this.height/2,"red")}handlePlayer(){game.state!==gameStates.credits&&(this.move(),this.moveTouch(),this.shoot(),this.shots.length>0&&this.shots.forEach(e=>{e.move()}))}}const gameStates={titleScreen:"displaying title screen",spaceshipAnimation:"running spaceship animation",asteroidsRound:"runs asteroids level",enemyShipRound:"runs enemy ship level",obstacleRound:"runs obstacle level",snakeRound:"runs snake level",bossRound:"runs boss level",gameOver:"game is over",credits:"credits are shown"},rounds={asteroids:"asteroid level",enemyShips:"enemy ships level",obstacles:"obstacle level",snake:"snake level",boss:"boss level"},screens={title:"title screen",highScores:"highScore list"},intervals={game:null,enemies:null,background:null,listenForStart:null,spaceShipAnimation:null,bossPositionSwapping:null},clearAllGameIntervals=()=>{Object.keys(intervals).forEach(i=>{clearInterval(intervals[i]),delete intervals[i]})};class Game{constructor(){this.state=gameStates.titleScreen,this.round=null,this.score=0,this.highScore="LOAD...",this.isHighScore=!1,this.highScores=null,this.highScoresLoaded=!1,this.highScoresLoading=!1,this.loadingAnimation=".",this.gameSpeed=60,this.musicRunning=!1,this.animationBackgroundScrollPosition=-1900,this.backgroundScrollPositions=[0,-2200],this.gameLoaded=0,this.displayedScreen=screens.title,this.player=new Player,this.respawnAsteroids=!1,this.asteroids=[],this.enemyShips=[],this.enemyShots=[],this.obstacles=null,this.currentGapPattern=0,this.snake=null,this.dualSnakes=null,this.boss=null,this.boss2=null,this.colorVariable=0,this.powerUp=null,this.level=1,this.music=sounds.gameMusic2,this.gameWon=!1,this.creditsStartTime=null,this.blinkingTextStartTime=performance.now()}getLevelByRound(){let e;switch(this.round){case rounds.asteroids:case null:e=1;break;case rounds.enemyShips:e=2;break;case rounds.obstacles:e=3;break;case rounds.snake:case rounds.boss:e=4;break;default:e=1;break}return`${this.level}-${e}`}startGame(){for(let e in sounds)sounds[e]instanceof Audio&&(sounds[e].playbackRate=1);playSound("spaceshipSound"),this.state=gameStates.spaceshipAnimation}resetGame(){this.player.shots.length=0,this.player.shotCoolDown=!1,this.enemyShots=[],this.resetAsteroids(),this.snake=new Snake(this.addSnakeElements(),this.colorVariable),this.dualSnakes=[new Snake(this.addDualSnakes().snake1,this.colorVariable),new Snake(this.addDualSnakes().snake2,this.colorVariable)],this.boss=new Boss,this.boss2=new Boss2,this.player.x=canvas.width/2-this.player.width/2,this.player.killed=!1,this.player.y=canvas.height-this.player.height,this.powerUp=null,this.enemyShips.length=0,this.enemyShips.push(new EnemyShip(0,60,!1),new EnemyShip(260,120,!0)),this.level>1&&this.enemyShips.push(new EnemyShip(0,180,!1)),buttonsPressed.a=!1,buttonsPressed.d=!1,buttonsPressed.w=!1,this.animationBackgroundScrollPosition=-1900,sounds.credits.pause(),sounds.credits.currentTime=0}handleGameOver(){this.player.killed=!0,window.navigator.vibrate(1e3),this.round=null,clearInterval(intervals.enemies),clearInterval(intervals.game),clearInterval(intervals.background),clearInterval(intervals.bossPositionSwapping),this.music.playbackRate=.5,this.musicRunning=!1,setTimeout(()=>{this.music.pause()},1e3),playSound("loseSound"),setTimeout(()=>{this.state=gameStates.gameOver,this.isHighScore=!1,this.gameSpeed=60},2e3)}runGame=()=>{this.player.handlePlayer(),this.setScore()};startNextRound(){switch(this.resetGame(),clearAllGameIntervals(),particles=[],this.round){case null:this.respawnAsteroids=!0,this.round=rounds.asteroids,this.state=gameStates.asteroidsRound,setTimeout(()=>this.respawnAsteroids=!1,12e3);break;case rounds.boss:this.level+=1,this.respawnAsteroids=!0,this.round=rounds.asteroids,this.state=gameStates.asteroidsRound,this.level>1&&(this.powerUp=new PowerUp(powerUpTypes.shield)),setTimeout(()=>this.respawnAsteroids=!1,12e3);break;case rounds.asteroids:this.round=rounds.enemyShips,this.state=gameStates.enemyShipRound,this.level>1&&(this.powerUp=new PowerUp(powerUpTypes.wideShot));break;case rounds.obstacles:this.round=rounds.boss,this.state=gameStates.bossRound,this.powerUp=new PowerUp(powerUpTypes.longShot);break;case rounds.enemyShips:this.round=rounds.obstacles,this.state=gameStates.obstacleRound,this.obstacles=new ObstacleLevel(getPattern(this.currentGapPattern));break}intervals.game=setInterval(this.runGame,1e3/140),intervals.enemies=setInterval(this.runEnemies,1e3/this.gameSpeed),clearInterval(intervals.background),intervals.background=setInterval(game.moveBackground,1e3/140),this.round!==rounds.boss&&!this.musicRunning&&(this.music&&this.music.pause(),this.music=this.level===2?sounds.gameMusic3:sounds.gameMusic2,this.music.playbackRate=1,playMusic(this.music,!0),this.musicRunning=!0),this.round===rounds.boss&&(this.music.pause(),this.music=sounds.gameMusic,playMusic(this.music,!0),this.musicRunning=!1,playSound("bossAlert"),this.level===4&&(intervals.bossPositionSwapping=setInterval(()=>this.boss2.swapPositions(),3e3)))}endLevel(){this.player.resetShots(),clearInterval(intervals.enemies),clearInterval(intervals.game),setTimeout(()=>{this.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>this.moveShipForAnimation(),1e3/120),playSound("spaceshipSound"),this.gameSpeed<100&&(this.gameSpeed+=2),canvasContext.fillStyle="#5eead4",canvasContext.fillText("Next round!",100,canvas.height/2)},500)}runEnemies=()=>{switch(this.powerUp&&(this.powerUp.move(),this.powerUp.detectCollisionWithPlayer()),this.round){case rounds.asteroids:this.runAsteroidsLevel();break;case rounds.enemyShips:this.runEnemyShipsLevel();break;case rounds.obstacles:this.runObstaclesLevel();break;case rounds.boss:this.runBossLevel();break;default:break}this.enemyShots.forEach(e=>{e.move(),e.detectHittingPlayer()}),this.enemyShots=this.enemyShots.filter(e=>e.isActive&&e.y<canvas.height)};runAsteroidsLevel(){this.asteroids.forEach(e=>{e.moveAsteroid(),e.detectCollisionWithShip(),this.player.shots.forEach(s=>e.detectCollisionWithShot(s))}),this.asteroids.length===0&&this.endLevel()}runEnemyShipsLevel(){this.moveShipEnemies(),this.enemyShips.forEach(e=>e.handleShots())}runObstaclesLevel(){this.obstacles.update(),this.obstacles.isOver()&&(this.score+=100,this.currentGapPattern+=1,this.endLevel())}runBossLevel(){if(this.level===3)this.boss.isActive||setTimeout(()=>this.boss.activate(),3e3),this.boss.move(),this.boss.moveObstacles(),this.boss.handleShots(),this.boss.elements.forEach(s=>this.player.shots.forEach(t=>s.hitDetection(t))),this.boss.obstacles&&this.boss.obstacles.forEach(s=>{s.detectCollisionWithShip(),this.player.shots.forEach(t=>s.hitDetection(t))}),this.boss.elements.find(s=>s.isHead).lives<=0&&(this.boss.elements.forEach((s,t)=>{setTimeout(()=>{playSound("explosion"),s.lives=.5},t*60)}),game.score+=500,this.endLevel());else if(this.level===2){this.dualSnakes.some(t=>t.isActive)||setTimeout(()=>{this.dualSnakes.forEach(t=>t.activate())},3e3),this.dualSnakes.forEach(t=>{t.move(),t.detectHitByPlayer()});const e=this.dualSnakes[0].isDead(),s=this.dualSnakes[1].isDead();e&&this.dualSnakes[0].runDeathAnimation(),s&&this.dualSnakes[1].runDeathAnimation(),e&&s&&(game.score+=250,this.endLevel())}else this.level===4?(this.boss2.isActive||setTimeout(()=>this.boss2.activate(),3e3),this.boss2.detectHitByPlayer(),this.boss2.handleShots(),this.boss2.elements.some(e=>e.isHead&&e.lives>0)||(this.boss2.runDeathAnimation(),this.music.playbackRate=.5,setTimeout(()=>{this.music.pause()},2e3),this.gameWon||(this.score+=1e3,clearInterval(intervals.game),clearInterval(intervals.bossPositionSwapping),clearInterval(intervals.background),setTimeout(()=>{this.music.pause(),this.round=null,this.player.losePowerUps(),clearInterval(intervals.enemies),this.musicRunning=!1,this.isHighScore=!1,this.gameSpeed=60,playMusic(sounds.credits),this.state=gameStates.credits},3e3)),this.gameWon=!0)):(this.snake.isActive||setTimeout(()=>this.snake.activate(),3e3),this.snake.move(),this.snake.detectHitByPlayer(),this.snake.isDead()&&(this.snake.runDeathAnimation(),game.score+=150,this.endLevel()))}moveShipEnemies(){for(let e=this.enemyShips.length-1;e>=0;e--){const s=this.enemyShips[e];if(s.lives<=0){this.enemyShips.splice(e,1);continue}s.moveShip(),this.player.shots.forEach(t=>s.detectHitByPlayer(t))}this.enemyShips.length===1&&this.enemyShips[0].moveDown(),this.enemyShips.length===0&&this.endLevel()}setScore(){this.score>this.highScore&&(this.highScore=this.score,this.isHighScore=!0)}switchInfoScreen(){this.state!==gameStates.titleScreen||!this.highScoresLoaded||(setTimeout(()=>this.switchInfoScreen(),5e3),this.displayedScreen===screens.title?this.displayedScreen=screens.highScores:this.displayedScreen=screens.title)}drawStartScreen(){if(canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),canvasContext.textAlign="center",canvasContext.fillStyle="#5eead4",!this.highScoresLoaded&&!this.highScoresLoading){this.fetchHighScores();return}this.displayedScreen===screens.title&&this.drawTitleScreen(),this.displayedScreen===screens.highScores&&this.drawHighScores()}drawTitleScreen(){const t=(performance.now()-this.blinkingTextStartTime)%(2*800)<800;canvasContext.drawImage(images.background,0,this.animationBackgroundScrollPosition),t&&(canvasContext.fillText(this.gameLoaded<100?`Loading: ${this.gameLoaded}%`:"Press S to start",canvas.width/2,canvas.height/2),canvasContext.fillText(this.gameLoaded<100?this.loadingAnimation:"",canvas.width/2,canvas.height/2)),canvasContext.save(),canvasContext.font="12px retro",canvasContext.textAlign="right",canvasContext.fillText(`version ${versionNumber}`,canvas.width-10,canvas.height-10),canvasContext.restore(),canvasContext.save(),canvasContext.fillStyle="#5eead4",canvasContext.font="48px retro",canvasContext.textAlign="center",canvasContext.strokeStyle="#5eead4",canvasContext.lineWidth=1,canvasContext.fillText("SPACE",canvas.width/2,canvas.height/2-140),canvasContext.strokeText("SPACE",canvas.width/2,canvas.height/2-140),canvasContext.fillText("FORCE",canvas.width/2,canvas.height/2-100),canvasContext.strokeText("FORCE",canvas.width/2,canvas.height/2-100),canvasContext.restore(),this.drawLoadingAnimation()}drawHighScores(){if(canvasContext.fillText("HighScores",canvas.width/2,70),!this.highScores||this.highScores.length<=1)canvasContext.textAlign="left",canvasContext.fillText("Loading...",20,190);else for(let e=0;e<8;e++)canvasContext.textAlign="left",canvasContext.fillText(e+1+" "+this.highScores[e].Player,20,e*50+140),canvasContext.textAlign="right",canvasContext.fillText(this.highScores[e].Score,canvas.width-20,e*50+140)}drawLoadingAnimation(){this.loadingAnimation.length<3&&(this.loadingAnimation+="."),this.loadingAnimation.length>=3&&(this.loadingAnimation="")}drawGameOverScreen(){canvasContext.filter="none",canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),canvasContext.fillStyle="#5eead4",canvasContext.textAlign="center",canvasContext.fillText("Game over",canvas.width/2,canvas.height/2-100),canvasContext.fillText("Score: "+this.score,canvas.width/2,canvas.height/2-50),nameInput.style.display="block",nameInput.focus(),this.isHighScore&&canvasContext.fillText("New HighScore",canvas.width/2,100)}drawCreditsScreen(){const e=["","","","","MISSION COMPLETE","You saved Earth!","","","GAME CREDITS","","","a game by","Christian Eckardt","","","Music by","sawsquarenoise","","","Special Thanks to","All Players","","","Final Score",`${this.score}`,"","","Thank you","for playing!"];canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),this.creditsStartTime||(this.creditsStartTime=performance.now());const s=(performance.now()-this.creditsStartTime)/1e3,t=50,h=canvas.height+50;canvasContext.font="24px retro",canvasContext.fillStyle="#5eead4",canvasContext.textAlign="center",e.forEach((n,r)=>{const l=h-s*t+r*40;l>-30&&l<canvas.height+30&&(n==="CONGRATULATIONS!"||n==="GAME CREDITS"?(canvasContext.font="32px retro",canvasContext.fillText(n,canvas.width/2,l),canvasContext.font="24px retro"):n===`${this.score}`?canvasContext.fillText(this.score.toString(),canvas.width/2,l):canvasContext.fillText(n,canvas.width/2,l))});const o=e.length*40;(s*t>h+o+50||buttonsPressed.w)&&(this.state=gameStates.gameOver)}drawShipAndShot(){this.player.shots.length>0&&this.player.shots.forEach(e=>{e.draw()}),this.player.draw()}drawScore(){canvasContext.textAlign="start",canvasContext.fillStyle="#5eead4",canvasContext.fillText("Score",12,30),canvasContext.fillStyle="white",canvasContext.fillText(this.score,12,55),canvasContext.textAlign="right",canvasContext.fillStyle="#5eead4",canvasContext.fillText("Hi-Score",canvas.width-12,30),canvasContext.fillStyle="white",canvasContext.fillText(this.highScore,canvas.width-12,55),canvasContext.textAlign="center",canvasContext.fillStyle="#5eead4",canvasContext.fillText("LVL",canvas.width/2-25,30),canvasContext.fillStyle="white",canvasContext.fillText(`${this.getLevelByRound()}`,canvas.width/2-25,55)}drawSpaceshipAnimation(){this.score===0?canvasContext.drawImage(images.background,0,this.animationBackgroundScrollPosition):(canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height)),canvasContext.fillStyle="#5eead4",canvasContext.textAlign="center",canvasContext.fillText(this.score===0?"Save earth!":"Next round!",canvas.width/2,canvas.height/2),canvasContext.drawImage(images.playerShip,this.player.x,this.player.y,this.player.width,this.player.height),this.player.hasShield&&this.player.drawShield()}moveShipForAnimation(){this.player.y-=4,this.animationBackgroundScrollPosition<80&&(this.animationBackgroundScrollPosition+=2),this.player.y<-50&&(clearInterval(intervals.spaceShipAnimation),this.startNextRound())}drawEverything=()=>{switch(canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),this.backgroundScrollPositions.forEach(e=>{e&&canvasContext.drawImage(images.backgroundLoop1,0,e)}),this.drawShipAndShot(),this.state){case gameStates.asteroidsRound:this.asteroids.forEach(e=>e.drawAsteroid()),this.powerUp&&this.powerUp.draw();break;case gameStates.enemyShipRound:this.enemyShips.forEach(e=>{e.draw()}),this.powerUp&&this.powerUp.draw();break;case gameStates.obstacleRound:this.obstacles.draw();break;case gameStates.bossRound:this.powerUp&&this.powerUp.draw(),this.level===3?this.boss.draw():this.level===2?this.dualSnakes.forEach(e=>e.draw()):this.level===4?this.boss2.draw():this.snake.draw();break;default:break}switch(this.enemyShots.forEach(e=>{e.draw()}),this.drawScore(),this.state){case gameStates.titleScreen:this.drawStartScreen();break;case gameStates.spaceshipAnimation:this.drawSpaceshipAnimation();break;case gameStates.gameOver:this.drawGameOverScreen();break;case gameStates.credits:this.drawCreditsScreen();break;default:break}particles.forEach((e,s)=>{e.alpha<=0?particles.splice(s,1):(e.update(),e.draw())}),requestAnimationFrame(this.drawEverything)};moveBackground=()=>{this.backgroundScrollPositions.forEach((e,s)=>{e<2200?this.backgroundScrollPositions[s]+=1:this.backgroundScrollPositions[s]=-2200})};fetchHighScores(){this.highScoresLoading=!0,fetch("https://shooter-backend-vercel.vercel.app/api/getHighscores").then(e=>e.json()).then(e=>this.highScores=e).then(()=>{this.highScore=this.highScores[0]?.Score||1e3,this.highScoresLoaded=!0,this.highScoresLoading=!1,setTimeout(()=>this.switchInfoScreen(),3e3)}).catch(()=>this.highScoresLoaded=!0)}postHighScore(e){e.preventDefault();let s=nameInput.value;s.length===0&&(s="Player");const t={Player:s,Score:game.score};fetch("https://shooter-backend-vercel.vercel.app/api/postHighscore",{method:"post",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)}).then(h=>h.json()).catch(h=>console.log(h)),nameInput.value="",buttonsPressed.s=!1,nameInput.style.display="none",this.highScoresLoaded=!1,this.fetchHighScores(),this.state=gameStates.titleScreen,this.round=null,this.resetGame()}addAsteroids(){this.asteroids.push(new Asteroid(100,-50,30,2.5),new Asteroid(200,-100,40,2.8),new Asteroid(300,-200,60,2.6),new Asteroid(150,-300,80,2.6),new Asteroid(50,-150,30,3.2),new Asteroid(250,-400,100,2.4),new Asteroid(0,-400,80,3.6))}resetAsteroids(){this.asteroids.length=0,this.addAsteroids(),this.setActiveAsteroids()}setActiveAsteroids(){for(let e=this.asteroids.length-1;e>=0;e--)this.asteroids[e].hit&&this.asteroids.splice(e,1)}addSnakeElements(){return[new SnakeElement(0,-40,!0),new SnakeElement(40,-40,!1),new SnakeElement(80,-40,!1),new SnakeElement(120,-40,!1),new SnakeElement(160,-40,!1),new SnakeElement(200,-40,!1),new SnakeElement(240,-40,!1),new SnakeElement(280,-40,!1)]}addDualSnakes(){return{snake1:[new SnakeElement(0,-40,!0),new SnakeElement(40,-40,!1),new SnakeElement(80,-40,!1),new SnakeElement(120,-40,!1),new SnakeElement(160,-40,!1)],snake2:[new SnakeElement(canvas.width-160,-80,!0),new SnakeElement(canvas.width-120,-80,!1),new SnakeElement(canvas.width-80,-80,!1),new SnakeElement(canvas.width-40,-80,!1),new SnakeElement(canvas.width,-80,!1)]}}}const game=new Game;class Asteroid{constructor(e,s,t,h){this.x=e,this.y=s,this.width=t,this.height=t,this.hit=!1,this.speed=h}moveAsteroid(){this.hit||(game.score<400?this.y+=this.speed:game.score<800?this.y+=this.speed+.2:game.score<1200?this.y+=this.speed+.6:this.y+=this.speed+1,this.y>canvas.height&&(this.hit=!0,game.setActiveAsteroids(),game.respawnAsteroids&&this.addNewAsteroid()))}drawAsteroid(){this.hit||canvasContext.drawImage(images.asteroid,this.x,this.y,this.width,this.height)}addNewAsteroid(){const t=canvas.width-this.width,h=0,o=-(Math.random()*250)-100,a=Math.random()*(t-h)+h;game.respawnAsteroids&&game.asteroids.push(new Asteroid(a,o,this.width,this.speed)),game.setActiveAsteroids()}detectCollisionWithShip(){if(this.hit)return;const e=6,s=game.player.x+e<this.x+this.width&&game.player.x+game.player.width-e>this.x,t=game.player.y+e<this.y+this.height&&game.player.y+game.player.height-e>this.y;s&&t&&(!game.player.hasShield&&game.player.isInvincible&&(this.hit=!0,game.setActiveAsteroids()),game.player.hasShield?(game.player.losePowerUps(),this.hit=!0,game.setActiveAsteroids(),setTimeout(()=>{game.player.hasShield||(game.player.isInvincible=!1)},500)):game.player.isInvincible||game.handleGameOver())}detectCollisionWithShot(e){const s=e.x<this.x+this.width&&e.x+e.width>this.x,t=e.y<this.y+this.height&&e.y+e.currentHeight>this.y;s&&t&&(e.isActive=!1,game.player.setActiveShots(),playSound("hitSound"),game.score+=5,createExplosion(this.x+this.width/2,this.y+this.height/2,"#5eead4"),this.hit=!0,game.setActiveAsteroids(),this.addNewAsteroid())}}class EnemyShip{constructor(e,s,t){this.x=e,this.y=s,this.width=60,this.height=60,this.speed=this.isLockOn?3:4,this.lives=game.level>1?4:2,this.isShotCoolDown=!1,this.shotCoolDown=400,this.isLockOn=game.level>1?t:!1,this.isLockOnMode=!1}draw(){this.lives>=1&&canvasContext.drawImage(images.enemyShip,this.x,this.y,this.width,this.height),game.player.killed}shoot(){this.isShotCoolDown||game.player.killed||(this.x+60>=game.player.x&&this.x<=game.player.x+60&&this.lives>=1&&(game.enemyShots.push(new EnemyShot(this)),playSound("laserEnemy")),this.isShotCoolDown=!0,setTimeout(()=>this.isShotCoolDown=!1,this.shotCoolDown))}moveShip(){!this.isLockOnMode&&this.isLockOn&&(this.isLockOnMode=!0,setTimeout(()=>this.isLockOnMode=!1,1e3)),this.isLockOnMode?(this.x<game.player.x&&(this.x+=Math.abs(this.speed)),this.x>game.player.x&&(this.x-=Math.abs(this.speed))):this.x+=this.speed,(this.x<=0||this.x>=canvas.width-40)&&(this.speed=-this.speed)}moveDown(){this.y<canvas.height-200&&(this.y+=1)}handleShots(){game.player.killed||this.shoot()}detectHitByPlayer(e){if(this.lives<=0)return;const s=e.y<this.y+this.height&&e.y+e.currentHeight>this.y,t=e.x<this.x+this.width&&e.x+e.width>this.x;s&&t&&this.lives>=1&&e.isActive&&(this.lives-=.5,playSound(this.lives<=.5?"explosion2":"hitSound"),setTimeout(()=>this.lives-=.5,100),e.isActive=!1,game.player.setActiveShots(),game.score+=30,createExplosion(this.x+this.width/2,this.y+this.height/2,"#5eead4"))}}class EnemyShot{constructor(e){this.enemyShip=e,this.maxHeightShot=20,this.currentShotHeight=0,this.x=e.x,this.x2=e.x+30,this.y=e.y+10,this.isActive=!0,this.shotSpeed=4,this.shotWidth=10}draw(){this.isActive&&(this.currentShotHeight<this.maxHeightShot&&(this.currentShotHeight+=2),canvasContext.fillStyle="rgba(255,0,0,0.6)",canvasContext.fillRect(this.x,this.y,this.shotWidth,this.currentShotHeight),canvasContext.fillRect(this.x2,this.y,this.shotWidth,this.currentShotHeight),canvasContext.drawImage(images.enemyShot,this.x,this.y,this.shotWidth,this.currentShotHeight),canvasContext.drawImage(images.enemyShot,this.x2,this.y,this.shotWidth,this.currentShotHeight))}move(){this.isActive&&(this.y+=this.shotSpeed),this.y>canvas.height&&(this.isActive=!1),this.detectHittingPlayer()}detectHittingPlayer(){if(!this.isActive)return;const e=10,s=game.player.x+10+e<this.x+30&&game.player.x+80-10-e>this.x+20,t=game.player.x+10+e<this.x2+30&&game.player.x+80-10-e>this.x2+20,h=game.player.y+e<this.y+30&&game.player.y+10-e>this.y;(s||t)&&h&&this.enemyShip.lives>=1&&(game.player.hasShield?(game.player.losePowerUps(),this.currentShotHeight=0,this.isActive=!1,setTimeout(()=>{game.player.hasShield||(game.player.isInvincible=!1)},500)):game.player.isInvincible||game.handleGameOver())}}class Snake{constructor(e,s){this.elements=e,this.color=s,this.isActive=!1,this.blinkingTextStartTime=performance.now()}activate(){this.isActive=!0,this.elements.forEach(e=>e.isActive=!0)}move(){this.isActive&&this.elements.forEach(e=>{e.move(),e.handleShots()})}draw(){this.isActive?(canvasContext.save(),canvasContext.filter=`hue-rotate(${game.colorVariable}deg)`,this.elements.forEach(e=>e.draw()),canvasContext.restore()):(performance.now()-this.blinkingTextStartTime)%(2*550)<550&&drawBossWarning(this.blinkingTextStartTime)}detectHitByPlayer(){this.elements.forEach(e=>{game.player.shots.forEach(s=>e.hitDetection(s))})}isDead(){return this.elements.find(e=>e.isHead).lives===0}runDeathAnimation(){this.elements.forEach((e,s)=>{e.isActive&&setTimeout(()=>{playSound("explosion"),e.lives=.5,createExplosion(e.x-e.size/2,e.y-e.size/2,"#5eead4"),s===this.elements.length-1&&this.elements.forEach(t=>{t.lives=0,t.isActive=!1})},s*60)})}}class SnakeElement{constructor(e,s,t,h){this.isHead=t,this.x=e,this.y=s,this.size=40,this.speed=8,this.lives=t?4:1,this.image=t?images.snakeHead:images.snakeBody,this.isShotCoolDown=!1,this.shotCoolDown=750,this.regenerates=h,this.isActive=!1}draw(){if(canvasContext.fillStyle="#80008055",this.lives===0&&this.isActive){canvasContext.fillRect(this.x,this.y+this.size/2-4,this.size,8);return}this.lives>.5&&canvasContext.drawImage(this.regenerates?images.bossStructure:this.image,this.x,this.y,this.size,this.size),game.player.killed}move(){this.isActive&&(this.x-=this.speed,(this.x<-50||this.x>400)&&(this.y+=40,this.speed=-this.speed),this.lives>.5&&this.y>=450&&this.x<canvas.width-20&&game.handleGameOver())}moveAsBoss(){this.x-=this.speed/4,(this.x<=-120||this.x>canvas.width+120)&&(this.speed=-this.speed,this.y+=5)}shoot(){!this.isHead||!this.isActive||this.isShotCoolDown||this.x<0||this.y<0||this.x>canvas.width-this.size||this.lives===0||(this.isShotCoolDown=!0,game.enemyShots.push(new EnemyShot(this)),playSound("laserEnemy"),setTimeout(()=>this.isShotCoolDown=!1,this.shotCoolDown))}handleShots(){game.player.killed||!this.isHead||this.lives===0||this.shoot()}hitDetection(e){if(this.y<0)return;const s=e.y<this.y+this.size&&e.y+e.currentHeight>this.y,t=e.x<this.x+this.size&&e.x+e.width>this.x;s&&t&&this.lives>.5&&(e.isActive=!1,game.player.setActiveShots(),game.colorVariable+=50,this.lives-=.5,setTimeout(()=>{this.lives-=.5,this.regenerates||(game.score+=10),this.lives===0&&this.regenerates&&setTimeout(()=>this.lives=1,1e3)},100),setTimeout(()=>{game.colorVariable-=50},50),playSound(this.isHead?"bossHitSound":"hitSound"),createExplosion(this.x-this.size/2,this.y-this.size/2,"#5eead4"),createExplosion(this.x-this.size/2,this.y-this.size/2,"#5eead4"))}changePosition(e,s){this.x=e,this.y=s}}function drawBossWarning(i){if((performance.now()-i)%1100<550){canvasContext.save();const o=(Math.random()-.5)*4,a=(Math.random()-.5)*4;canvasContext.translate(o,a),canvasContext.font="32px retro",canvasContext.textAlign="center",canvasContext.fillStyle="#FF4D00",canvasContext.fillText("BOSS",canvas.width/2+2,canvas.height/2-18),canvasContext.fillText("APPROACHES",canvas.width/2+2,canvas.height/2+22),canvasContext.fillText("BOSS",canvas.width/2,canvas.height/2-20),canvasContext.fillText("APPROACHES",canvas.width/2,canvas.height/2+20),canvasContext.restore()}}class Boss2{constructor(){this.elements=[new SnakeElement(0,80,!1,!0),new SnakeElement(40,80,!1,!0),new SnakeElement(80,80,!1,!0),new SnakeElement(120,80,!1,!0),new SnakeElement(160,80,!1,!0),new SnakeElement(200,80,!1,!0),new SnakeElement(240,80,!1,!0),new SnakeElement(280,80,!1,!0),new SnakeElement(320,80,!1,!0),new SnakeElement(360,80,!1,!0),new SnakeElement(0,120,!1,!0),new SnakeElement(80,120,!1,!0),new SnakeElement(160,120,!1,!0),new SnakeElement(200,120,!1,!0),new SnakeElement(280,120,!1,!0),new SnakeElement(360,120,!1,!0),new SnakeElement(0,160,!1,!0),new SnakeElement(40,160,!1,!0),new SnakeElement(80,160,!1,!0),new SnakeElement(120,160,!1,!0),new SnakeElement(160,160,!1,!0),new SnakeElement(200,160,!1,!0),new SnakeElement(240,160,!1,!0),new SnakeElement(280,160,!1,!0),new SnakeElement(320,160,!1,!0),new SnakeElement(360,160,!1,!0),new SnakeElement(40,120,!0,!1),new SnakeElement(120,120,!0,!1),new SnakeElement(240,120,!0,!1),new SnakeElement(320,120,!0,!1)],this.isActive=!1,this.blinkingTextStartTime=performance.now(),this.isDead=!1}draw(){canvasContext.save(),canvasContext.filter=`hue-rotate(${game.colorVariable}deg)`,this.elements.forEach(h=>h.draw()),canvasContext.restore(),(performance.now()-this.blinkingTextStartTime)%(2*550)<550&&!this.isActive&&drawBossWarning(this.blinkingTextStartTime)}activate(){this.isActive=!0,this.elements.forEach(e=>e.isActive=!0)}handleShots(){this.isDead||this.elements.forEach(e=>e.handleShots())}detectHitByPlayer(){this.elements.forEach(e=>{game.player.shots.forEach(s=>e.hitDetection(s))})}swapPositions(){if(!this.isActive)return;const e=[],s=[];this.elements.forEach((t,h)=>{t.isHead&&t.lives>0?e.push(h):!t.isHead&&t.lives>0&&s.push(h)}),!(e.length===0||s.length===0)&&(e.forEach(t=>{const h=s[Math.floor(Math.random()*s.length)],o=this.elements[t].x,a=this.elements[t].y,n=this.elements[h].x,r=this.elements[h].y;this.elements[t].changePosition(n,r),this.elements[h].changePosition(o,a)}),playSound("teleport"))}runDeathAnimation(){this.isDead||(this.isDead=!0,this.elements.forEach((e,s)=>{e.shots=[],e.regenerates=!1,setTimeout(()=>{playSound("explosion"),createExplosion(e.x-e.size/2,e.y-e.size/2,"#5eead4"),e.lives=.5,s===this.elements.length-1&&this.elements.forEach(t=>{t.lives=0,t.isActive=!1})},s*60)}))}}class Boss{constructor(){this.elements=[new SnakeElement(canvas.width,60,!1,!0),new SnakeElement(canvas.width+40,60,!1,!0),new SnakeElement(canvas.width+80,60,!1,!0),new SnakeElement(canvas.width,100,!1,!0),new SnakeElement(canvas.width+80,100,!1,!0),new SnakeElement(canvas.width,140,!1,!0),new SnakeElement(canvas.width+40,140,!1,!0),new SnakeElement(canvas.width+80,140,!1,!0),new SnakeElement(canvas.width+40,100,!0,!1)],this.obstacles=null,this.moves=!0,this.bossPosition="canvas",this.isActive=!1,this.blinkingTextStartTime=performance.now()}draw(){canvasContext.save(),canvasContext.filter=`hue-rotate(${game.colorVariable}deg)`,this.elements.forEach(h=>h.draw()),this.obstacles&&this.obstacles.forEach(h=>h.draw()),canvasContext.restore(),(performance.now()-this.blinkingTextStartTime)%(2*550)<550&&!this.isActive&&drawBossWarning(this.blinkingTextStartTime)}activate(){this.isActive=!0,this.elements.forEach(e=>e.isActive=!0)}handleShots(){this.elements.forEach(e=>e.handleShots())}move(){if(!this.isActive||!this.moves&&this.obstacles!==null)return;this.elements.forEach(t=>t.moveAsBoss());const e=!this.elements.some(t=>t.x>-50),s=!this.elements.some(t=>t.x<canvas.width+10);this.bossPosition!=="right-outbound"&&s?(this.bossPosition="right-outbound",this.moves=!1,this.setObstacles()):this.bossPosition!=="left-outbound"&&e&&(this.bossPosition="left-outbound",this.moves=!1,this.setObstacles())}setObstacles(){const e=Math.floor(Math.random()*9),s=[];for(let t=0;t<10;t++){if(t===e||t===e+1)continue;const h=t*40;s.push(new Obstacle(h,-40,!0),new Obstacle(h,-80,!0),new Obstacle(h,-120,!0),new Obstacle(h,-160,!0))}this.obstacles=s}moveObstacles(){this.moves||(this.obstacles.forEach(e=>e.move()),this.obstacles.some(e=>e.y<canvas.height)||(this.moves=!0,this.obstacles=null))}}class Obstacle{constructor(e,s,t){this.x=e,this.y=s,this.isActive=t,this.speedY=4,this.size=canvas.width/10,this.lives=1}draw(){!this.isActive||this.y<0-this.size||this.y>canvas.height+this.size||this.lives>.5&&canvasContext.drawImage(images.bossStructure,this.x,this.y,this.size,this.size)}move(){this.y+=this.speedY}hitDetection(e){if(!this.isActive||this.y<0-this.size||this.y>canvas.height+this.size)return;const s=e.y<this.y+this.size&&e.y+e.currentHeight>this.y,t=e.x<this.x+this.size&&e.x+e.width>this.x;s&&t&&this.lives>.5&&(createExplosion(this.x+this.size/2,this.y+this.size/2,"#5eead4"),e.isActive=!1,game.player.setActiveShots(),this.lives-=.5,setTimeout(()=>{this.lives-=.5,this.isActive=!1},100),playSound("hitSound"))}detectCollisionWithShip(){if(!this.isActive)return;const e=6,s=game.player.x+e<this.x+this.size&&game.player.x+game.player.width-e>this.x,t=game.player.y+e<this.y+this.size&&game.player.y+game.player.height-e>this.y;if(s&&t){if(!game.player.hasShield&&game.player.isInvincible){this.isActive=!1;return}game.player.hasShield?(game.player.losePowerUps(),this.isActive=!1,setTimeout(()=>{game.player.hasShield||(game.player.isInvincible=!1)},500),game.player.isInvincible=!0):game.player.isInvincible||game.handleGameOver()}}}const getPattern=()=>gapPatterns[game.level-1],gapPattern=[[1,1,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,2,0,1],[1,1,1,1,0,0,0,0,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,2,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,1]],gapPattern2=[[1,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,2,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,2,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,2,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[1,1,1,1,1,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,1,1,1],[1,2,0,0,0,0,0,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,1]],gapPattern3=[[0,0,0,0,0,0,0,0,0,0],[1,0,0,0,1,1,0,0,0,1],[1,0,0,0,1,1,0,0,0,1],[1,0,0,0,1,1,0,2,0,1],[1,1,1,0,1,1,0,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,2,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,2,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[1,1,1,1,1,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,2,1,1,1],[1,0,0,0,0,0,0,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1]],gapPattern4=[[0,0,0,0,0,0,0,0,0,0],[1,0,1,1,1,1,0,0,0,1],[1,0,1,1,1,1,0,0,0,1],[1,0,1,1,1,1,0,0,0,1],[1,0,1,1,1,1,0,0,1,1],[1,2,1,0,0,0,0,0,0,1],[1,2,1,0,0,0,0,0,0,1],[1,2,1,0,0,0,0,0,0,1],[1,0,1,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,1,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,2,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[1,1,1,1,1,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,2,1,1,1],[1,0,0,0,0,0,0,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1]],gapPatterns=[gapPattern,gapPattern2,gapPattern3,gapPattern4];class Collectible{constructor(e,s){this.x=e,this.y=s,this.speedY=4,this.size=canvas.width/10,this.isCollected=!1}draw(){this.isCollected||canvasContext.drawImage(images.astronaut,this.x,this.y,this.size,this.size)}move(){this.y+=this.speedY}detectCollisionWithShip(){if(this.isCollected)return;const e=6,s=game.player.x+e<this.x+this.size&&game.player.x+game.player.width-e>this.x,t=game.player.y+e<this.y+this.size&&game.player.y+game.player.height-e>this.y;s&&t&&(createExplosion(this.x+this.size/2,this.y+this.size/2,"yellow"),this.isCollected=!0,game.score+=100,playSound("thankYou"))}hitDetection(){}}class ObstacleLevel{constructor(e){this.pattern=e,this.currentRow=0,this.activeObstacles=[],this.obstacleSize=canvas.width/10,this.y=-80}update(){if(this.currentRow<this.pattern.length){let e=!1;(this.activeObstacles.length===0||this.activeObstacles[this.activeObstacles.length-1].y>=0)&&(e=!0),e&&(this.pattern[this.currentRow].forEach((t,h)=>{t===1&&this.activeObstacles.push(new Obstacle(h*this.obstacleSize,-this.obstacleSize,!0)),t===2&&this.activeObstacles.push(new Collectible(h*this.obstacleSize,-this.obstacleSize))}),this.currentRow++)}for(let e=this.activeObstacles.length-1;e>=0;e--)this.activeObstacles[e].y>canvas.height+100&&this.activeObstacles.splice(e,1);this.activeObstacles.forEach(e=>e.move()),this.handleCollisions()}handleCollisions(){this.activeObstacles.forEach(e=>{e.y>canvas.height/4*3&&e.detectCollisionWithShip()}),game.player.shots.forEach(e=>{this.activeObstacles.forEach(s=>s.hitDetection(e))})}draw(){this.activeObstacles.forEach(e=>{e.y>=-20&&e.draw()})}isOver(){return!this.activeObstacles||!this.activeObstacles[this.activeObstacles.length-1]?!1:game.player.y+game.player.height<this.activeObstacles[this.activeObstacles.length-1].y}}const powerUpTypes={shield:"Shield power up",wideShot:"Wide shot power up",longShot:"Long shot power up"};function drawPowerUp(i,e,s,t){canvasContext.save(),canvasContext.beginPath();for(let r=0;r<20;r++){const d=r/20*Math.PI*2,l=(r+1)/20*Math.PI*2,c=i+s*Math.cos(d),u=e+s*Math.sin(d),p=i+s*Math.cos(l),f=e+s*Math.sin(l);canvasContext.lineTo(c,u),canvasContext.lineTo(p,f)}canvasContext.closePath(),canvasContext.strokeStyle="white",canvasContext.lineWidth=3,canvasContext.stroke(),canvasContext.beginPath(),canvasContext.arc(i,e,s-3,0,Math.PI*2);const o=canvasContext.createRadialGradient(i,e,0,i,e,s),a=getGradientByType(t);o.addColorStop(0,a.step1),o.addColorStop(1,a.step2),canvasContext.fillStyle=o,canvasContext.fill();const n=t.at(0);canvasContext.font=`${s}px retro`,canvasContext.textAlign="center",canvasContext.textBaseline="middle",canvasContext.fillStyle="white",canvasContext.fillText(n,i,e),canvasContext.restore()}function getGradientByType(i){if(i===powerUpTypes.shield)return{step1:"rgba(0, 255, 155, 0.6)",step2:"rgba(94, 234, 212, 0.6)"};if(i===powerUpTypes.wideShot)return{step1:"rgba(255, 155, 0, 0.6)",step2:"rgba(255, 115, 52, 0.6)"};if(i===powerUpTypes.longShot)return{step1:"rgba(0, 0, 255, 0.6)",step2:"rgba(94, 234, 212, 0.6)"}}class PowerUp{constructor(e){this.type=e,this.maxX=canvas.width-20,this.minX=20,this.x=Math.random()*(this.maxX-this.minX)+this.minX,this.y=-800,this.baseRadius=20,this.radius=20,this.pulseTime=0,this.pulseSpeed=.07,this.pulseRange=3,this.speedX=3,this.speedY=3,this.isActive=!0}draw(){this.isActive&&(this.pulseTime+=this.pulseSpeed,this.radius=this.baseRadius+Math.sin(this.pulseTime)*this.pulseRange,drawPowerUp(this.x,this.y,this.radius,this.type))}move(){this.isActive&&(this.y+=this.speedY,this.x+=this.speedX,this.x+=this.speedX,this.x>canvas.width&&(this.speedX=-this.speedX),this.x<0&&(this.speedX=-this.speedX)),this.y>canvas.height&&(this.isActive=!1)}detectCollisionWithPlayer(){if(!this.isActive)return;const e=Math.max(game.player.x,Math.min(this.x,game.player.x+game.player.width)),s=Math.max(game.player.y,Math.min(this.y,game.player.y+game.player.height)),t=this.x-e,h=this.y-s;t*t+h*h<this.radius*this.radius&&(this.isActive=!1,createExplosion(this.x+this.baseRadius,this.y+this.baseRadius,"yellow"),this.type===powerUpTypes.shield&&(game.player.hasShield&&(game.score+=50),game.player.hasShield=!0,game.player.isInvincible=!0),this.type===powerUpTypes.wideShot&&(game.player.hasWideShot&&(game.score+=50),game.player.hasWideShot=!0),this.type===powerUpTypes.longShot&&(game.player.hasLongShot&&(game.score+=50),game.player.hasLongShot=!0),playSound(this.type===powerUpTypes.shield?"shieldUp":"powerUp"))}}class Shot{constructor(e,s){this.isWideShot=e,this.isLongShot=s,this.width=this.isWideShot?20:10,this.fullHeight=this.isLongShot?100:20,this.currentHeight=0,this.x=game.player.x+game.player.width/2-this.width/2,this.y=game.player.y,this.isActive=!0,this.shotSpeed=6}move(){this.isActive&&(this.y-=this.shotSpeed),this.y<=-20&&(this.isActive=!1,game.player.setActiveShots()),this.currentHeight<this.fullHeight&&(this.currentHeight+=2)}draw(){!this.isWideShot&&!this.isLongShot&&canvasContext.drawImage(images.playerShot,this.x,this.y,this.width,this.fullHeight),this.isWideShot&&!this.isLongShot&&canvasContext.drawImage(images.wideShot,this.x,this.y,this.width,this.fullHeight),!this.isWideShot&&this.isLongShot&&canvasContext.drawImage(images.longShot,this.x,this.y,this.width,this.currentHeight),this.isWideShot&&this.isLongShot&&canvasContext.drawImage(images.wideAndLongShot,this.x,this.y,this.width,this.currentHeight)}playLaserSound(){let e;game.player.hasWideShot&&game.player.hasLongShot?e="laser3":game.player.hasWideShot||game.player.hasLongShot?e="laser2":e="laser",playSound(e)}}let particles=[];class Particle{constructor(e,s,t){this.x=e,this.y=s,this.color=t,this.size=Math.random()*4+2,this.speedX=(Math.random()-.5)*6,this.speedY=(Math.random()-.5)*6,this.alpha=1,this.decay=Math.random()*.02+.01}update(){this.x+=this.speedX,this.y+=this.speedY,this.alpha-=this.decay}draw(){canvasContext.save(),canvasContext.globalAlpha=this.alpha,canvasContext.fillStyle=this.color,canvasContext.fillRect(this.x,this.y,this.size,this.size),canvasContext.restore()}}const createExplosion=(i,e,s)=>{particles.length>400&&particles.splice(0,30);const t=30;for(let h=0;h<t;h++)particles.push(new Particle(i,e,"#5eead4"))},buttonsPressed={a:!1,d:!1,w:!1,s:!1},touchControls={x:null,active:!1};function changeTouchPosition(i){touchControls.active=!0,touchControls.x=i.targetTouches?i.targetTouches[0].pageX-canvas.offsetLeft:i.offsetX,buttonsPressed.s||(buttonsPressed.s=!0,game.score=0,game.startGame(),game.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>game.moveShipForAnimation(),1e3/120),buttonsPressed.s=!0)}function keyDownHandler(i){i.key==="a"||i.key==="ArrowLeft"?buttonsPressed.a=!0:i.key==="d"||i.key==="ArrowRight"?buttonsPressed.d=!0:(i.key==="w"||i.key==="ArrowUp")&&(buttonsPressed.w=!0),i.key==="s"&&!buttonsPressed.s&&game.gameLoaded>=100&&(game.score=0,game.startGame(),game.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>game.moveShipForAnimation(),1e3/120),buttonsPressed.s=!0)}function keyUpHandler(i){i.key==="a"||i.key==="ArrowLeft"?buttonsPressed.a=!1:i.key==="d"||i.key==="ArrowRight"?buttonsPressed.d=!1:(i.key==="w"||i.key==="ArrowUp")&&(buttonsPressed.w=!1)}window.onload=()=>{game.fetchHighScores(),loadImages(),loadSounds(),requestAnimationFrame(game.drawEverything),canvas.addEventListener("touchstart",changeTouchPosition,!1),canvas.addEventListener("touchmove",changeTouchPosition,!1),canvas.addEventListener("touchend",function(){touchControls.active=!1}),document.addEventListener("keydown",keyDownHandler,!1),document.addEventListener("keyup",keyUpHandler,!1),intervals.listenForStart=setInterval(()=>{navigator.getGamepads()[0]!==null&&!buttonsPressed.s&&navigator.getGamepads()[0].buttons[9].pressed&&(game.score=0,game.startGame(),game.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>game.moveShipForAnimation(),1e3/120),buttonsPressed.s=!0)},1e3/30),document.getElementById("high-score-form").onsubmit=function(i){i.preventDefault(),game.postHighScore(i)}};
