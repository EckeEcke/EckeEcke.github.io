const canvas=document.getElementById("game-canvas"),canvasContext=canvas.getContext("2d"),nameInput=document.getElementById("name-input");canvasContext.font="24px retro";const versionNumber="3.0.0",initStars=()=>{const i=document.getElementById("stars-container");for(let e=0;e<100;e++){const t=document.createElement("div");t.className="star";const s=Math.random()*100,h=Math.random()*100,o=Math.random()*3+2,n=Math.random()*5,a=Math.random()*2+1;Object.assign(t.style,{left:`${s}%`,top:`${h}%`,width:`${a}px`,height:`${a}px`,animationDuration:`${o}s`,animationDelay:`${n}s`}),i.appendChild(t)}};document.addEventListener("DOMContentLoaded",initStars);const imageSources={playerShip:"./images/shooter/player-ship.png",playerShot:"./images/shooter/player-shot.png",longShot:"./images/shooter/longshot.png",wideShot:"./images/shooter/wideshot.png",wideAndlongShot:"./images/shooter/wide-and-longshot.png",snakeHead:"./images/shooter/snake-head-new.png",snakeBody:"./images/shooter/snake-body-new.png",enemyShip:"./images/shooter/enemy-ship-new.png",enemyShot:"./images/shooter/enemy-shot.png",asteroid:"./images/shooter/asteroid.png",explosion:"./images/shooter/explosion.png",bossStructure:"./images/shooter/boss-structure.png",background:"./images/shooter/background.jpg",backgroundLoop:"./images/shooter/background-loop.jpg",astronaut:"./images/shooter/astronaut2.png"},images={playerShip:new Image,playerShot:new Image,longShot:new Image,wideShot:new Image,wideAndLongShot:new Image,snakeHead:new Image,snakeBody:new Image,enemyShip:new Image,enemyShot:new Image,asteroid:new Image,explosion:new Image,bossStructure:new Image,background:new Image,backgroundLoop1:new Image,backgroundLoop2:new Image,astronaut:new Image};function loadImages(){images.snakeHead.onload=()=>game.gameLoaded+=5,images.snakeBody.onload=()=>game.gameLoaded+=5,images.enemyShip.onload=()=>game.gameLoaded+=5,images.bossStructure.onload=()=>game.gameLoaded+=5,images.background.onload=()=>game.gameLoaded+=5,images.playerShip.onload=()=>game.gameLoaded+=5,images.explosion.onload=()=>game.gameLoaded+=5,images.asteroid.onload=()=>game.gameLoaded+=3,images.astronaut.onload=()=>game.gameLoaded+=2,images.snakeHead.src=imageSources.snakeHead,images.snakeBody.src=imageSources.snakeBody,images.enemyShip.src=imageSources.enemyShip,images.enemyShot.src=imageSources.enemyShot,images.bossStructure.src=imageSources.bossStructure,images.background.src=imageSources.background,images.backgroundLoop1.src=imageSources.backgroundLoop,images.backgroundLoop2.src=imageSources.backgroundLoop,images.playerShip.src=imageSources.playerShip,images.playerShot.src=imageSources.playerShot,images.longShot.src=imageSources.longShot,images.wideShot.src=imageSources.wideShot,images.wideAndLongShot.src=imageSources.wideAndlongShot,images.explosion.src=imageSources.explosion,images.asteroid.src=imageSources.asteroid,images.astronaut.src=imageSources.astronaut}const soundSources={laserEnemy:"./sounds/shooter/laser-enemy.wav",laser:"./sounds/shooter/laser.wav",laser2:"./sounds/shooter/laser2.wav",laser3:"./sounds/shooter/laser3.wav",powerUp:"./sounds/shooter/shooter-power-up.wav",hitSound:"./sounds/shooter/hit2.wav",bossHitSound:"./sounds/shooter/boss-hit2.wav",bossAlert:"./sounds/shooter/boss-alert.wav",spaceshipSound:"./sounds/shooter/spaceship-rising.wav",loseSound:"./sounds/shooter/lose-shooter.wav",gameMusic:"./sounds/shooter/space-shooter-music.mp3",gameMusic2:"./sounds/shooter/music2.mp3",gameMusic3:"./sounds/shooter/music3.mp3",shieldUp:"./sounds/shooter/shield-up.wav",shieldDown:"./sounds/shooter/shield-down.wav",explosion:"./sounds/shooter/explosion.wav",explosion2:"./sounds/shooter/explosion2.wav",thankYou:"./sounds/shooter/thank-you.mp3",teleport:"./sounds/shooter/teleport.wav",credits:"./sounds/shooter/credits.mp3"},sounds={laserEnemy:void 0,laser:void 0,laser2:void 0,laser3:void 0,powerUp:void 0,hitSound:void 0,bossHitSound:void 0,bossAlert:void 0,spaceshipSound:void 0,loseSound:void 0,gameMusic:void 0,gameMusic2:void 0,gameMusic3:void 0,shieldUp:void 0,shieldDown:void 0,explosion:void 0,explosion2:void 0,thankYou:void 0,teleport:void 0,credits:void 0};function loadSounds(){sounds.laserEnemy=new Audio(soundSources.laserEnemy),sounds.laserEnemy.onloadeddata=()=>game.gameLoaded+=5,sounds.laser=new Audio(soundSources.laser),sounds.laser.onloadeddata=()=>game.gameLoaded+=5,sounds.laser2=new Audio(soundSources.laser2),sounds.laser2.onloadeddata=()=>game.gameLoaded+=5,sounds.laser3=new Audio(soundSources.laser3),sounds.laser3.onloadeddata=()=>game.gameLoaded+=5,sounds.powerUp=new Audio(soundSources.powerUp),sounds.powerUp.onloadeddata=()=>game.gameLoaded+=5,sounds.hitSound=new Audio(soundSources.hitSound),sounds.hitSound.onloadeddata=()=>game.gameLoaded+=3,sounds.bossHitSound=new Audio(soundSources.bossHitSound),sounds.bossHitSound.onloadeddata=()=>game.gameLoaded+=1,sounds.bossAlert=new Audio(soundSources.bossAlert),sounds.bossAlert.onloadeddata=()=>game.gameLoaded+=1,sounds.spaceshipSound=new Audio(soundSources.spaceshipSound),sounds.spaceshipSound.onloadeddata=()=>game.gameLoaded+=5,sounds.loseSound=new Audio(soundSources.loseSound),sounds.loseSound.onloadeddata=()=>game.gameLoaded+=5,sounds.gameMusic=new Audio(soundSources.gameMusic),sounds.gameMusic.onloadeddata=()=>game.gameLoaded+=3,sounds.gameMusic.loop=!0,sounds.gameMusic2=new Audio(soundSources.gameMusic2),sounds.gameMusic2.onloadeddata=()=>game.gameLoaded+=1,sounds.gameMusic2.loop=!0,sounds.gameMusic3=new Audio(soundSources.gameMusic3),sounds.gameMusic3.onloadeddata=()=>game.gameLoaded+=1,sounds.gameMusic3.loop=!0,sounds.shieldUp=new Audio(soundSources.shieldUp),sounds.shieldUp.onloadeddata=()=>game.gameLoaded+=5,sounds.shieldDown=new Audio(soundSources.shieldDown),sounds.shieldDown.onloadeddata=()=>game.gameLoaded+=5,sounds.explosion=new Audio(soundSources.explosion),sounds.explosion.onloadeddata=()=>game.gameLoaded+=1,sounds.explosion2=new Audio(soundSources.explosion2),sounds.explosion2.onloadeddata=()=>game.gameLoaded+=1,sounds.thankYou=new Audio(soundSources.thankYou),sounds.thankYou.onloadeddata=()=>game.gameLoaded+=1,sounds.teleport=new Audio(soundSources.teleport),sounds.teleport.onloadeddata=()=>game.gameLoaded+=1,sounds.credits=new Audio(soundSources.credits),sounds.credits.onloadeddata=()=>game.gameLoaded+=1}function playSound(i){i.pause(),i.currentTime=0,i.play()}class Player{constructor(){this.height=64,this.width=40,this.x=canvas.width/2-this.width/2,this.y=canvas.height-this.height,this.killed=!1,this.coolDownPlayer=400,this.isShotCoolDown=!1,this.shots=[],this.activeShots=[],this.hasShield=!1,this.isInvincible=!1,this.hasWideShot=!1,this.hasLongShot=!1}setActiveShots(){this.activeShots=this.shots.filter(e=>e.isActive)}resetShots(){this.shots=[],this.setActiveShots()}draw(){!this.hasShield&&this.isInvincible?canvasContext.filter="hue-rotate(180deg) brightness(1.2) saturate(1.5)":canvasContext.filter="none",this.killed?canvasContext.drawImage(images.explosion,this.x+(this.height-this.width)/2,this.y,this.height,this.height):canvasContext.drawImage(images.playerShip,this.x,this.y,this.width,this.height),this.hasShield&&this.drawShield()}drawShield(){const t=this.x+this.width/2,s=this.y+this.height/2;canvasContext.beginPath(),canvasContext.arc(t,s,50,0,Math.PI*2);const h=canvasContext.createRadialGradient(t,s,0,t,s,50);h.addColorStop(0,"rgba(255, 0, 0, 0.3)"),h.addColorStop(1,"rgba(0, 0, 255, 0.3)"),canvasContext.fillStyle=h,canvasContext.fill()}move(){let e=navigator.getGamepads()[0]!==null;(buttonsPressed.a||e&&navigator.getGamepads()[0].buttons[14].pressed)&&(this.x-=3),this.x<0&&(this.x=0),(buttonsPressed.d||e&&navigator.getGamepads()[0].buttons[15].pressed)&&(this.x+=3),this.x>canvas.width-this.width&&(this.x=canvas.width-this.width)}moveTouch(){touchControls.active&&(this.x>touchControls.x&&(this.x-=4),this.x<touchControls.x&&(this.x+=4))}shoot(){if(this.isShotCoolDown)return;const e=navigator.getGamepads()[0]!==null;if(buttonsPressed.w||e&&navigator.getGamepads()[0].buttons[0].pressed||touchControls.active){this.isShotCoolDown=!0,setTimeout(()=>this.isShotCoolDown=!1,this.coolDownPlayer);const t=new Shot(this.hasWideShot,this.hasLongShot);this.shots.push(t),game.player.setActiveShots(),t.playLaserSound()}}losePowerUps(){playSound(sounds.shieldDown),this.hasShield=!1,this.hasWideShot=!1,this.hasLongShot=!1}handlePlayer(){game.state!==gameStates.credits&&(this.move(),this.moveTouch(),this.shoot(),this.activeShots.length>0&&this.activeShots.forEach(e=>{e.move()}))}}const gameStates={titleScreen:"displaying title screen",spaceshipAnimation:"running spaceship animation",asteroidsRound:"runs asteroids level",enemyShipRound:"runs enemy ship level",obstacleRound:"runs obstacle level",snakeRound:"runs snake level",bossRound:"runs boss level",gameOver:"game is over",credits:"credits are shown"},rounds={asteroids:"asteroid level",enemyShips:"enemy ships level",obstacles:"obstacle level",snake:"snake level",boss:"boss level"},screens={title:"title screen",highScores:"highScore list"},intervals={game:null,enemies:null,background:null,listenForStart:null,spaceShipAnimation:null,bossPositionSwapping:null};class Game{constructor(){this.state=gameStates.titleScreen,this.round=null,this.score=0,this.highScore="LOAD...",this.isHighScore=!1,this.highScores=null,this.highScoresLoaded=!1,this.highScoresLoading=!1,this.loadingAnimation=".",this.gameSpeed=60,this.musicRunning=!1,this.animationBackgroundScrollPosition=-1900,this.backgroundScrollPositions=[0,-2200],this.gameLoaded=0,this.displayedScreen=screens.title,this.volume=1,this.player=new Player,this.respawnAsteroids=!1,this.asteroids=[],this.activeAsteroids=[],this.enemyShips=[],this.obstacles=null,this.currentGapPattern=0,this.snake=null,this.dualSnakes=null,this.boss=null,this.boss2=null,this.colorVariable=0,this.powerUp=null,this.level=1,this.music=sounds.gameMusic2,this.gameWon=!1,this.creditsStartTime=null,this.blinkingTextStartTime=performance.now()}getLevelByRound(){let e;switch(this.round){case rounds.asteroids:case null:e=1;break;case rounds.enemyShips:e=2;break;case rounds.obstacles:e=3;break;case rounds.snake:case rounds.boss:e=4;break;default:e=1;break}return`${this.level}-${e}`}startGame(){for(let e in sounds)sounds[e]instanceof Audio&&(sounds[e].playbackRate=1);playSound(sounds.spaceshipSound),this.state=gameStates.spaceshipAnimation}resetGame(){this.player.shots.length=0,this.player.shotCoolDown=!1,this.resetAsteroids(),this.snake=new Snake(this.addSnakeElements(),this.colorVariable),this.dualSnakes=[new Snake(this.addDualSnakes().snake1,this.colorVariable),new Snake(this.addDualSnakes().snake2,this.colorVariable)],this.boss=new Boss,this.boss2=new Boss2,this.player.x=canvas.width/2-this.player.width/2,this.player.killed=!1,this.player.y=canvas.height-this.player.height,this.powerUp=null,this.enemyShips.length=0,this.enemyShips.push(new EnemyShip(0,60,!1),new EnemyShip(260,120,!0)),this.level>1&&this.enemyShips.push(new EnemyShip(0,180,!1)),buttonsPressed.a=!1,buttonsPressed.d=!1,buttonsPressed.w=!1,this.animationBackgroundScrollPosition=-1900,sounds.credits.pause(),sounds.credits.currentTime=0}handleGameOver(){this.player.killed=!0,window.navigator.vibrate(1e3),this.round=null,clearInterval(intervals.enemies),clearInterval(intervals.game),clearInterval(intervals.background),clearInterval(intervals.bossPositionSwapping),this.music.playbackRate=.5,this.musicRunning=!1,setTimeout(()=>{this.music.pause()},1e3),playSound(sounds.loseSound),setTimeout(()=>{this.state=gameStates.gameOver,this.isHighScore=!1,this.gameSpeed=60},2e3)}runGame=()=>{this.player.handlePlayer(),this.setScore()};startNextRound(){switch(this.resetGame(),this.round){case null:this.respawnAsteroids=!0,this.round=rounds.asteroids,this.state=gameStates.asteroidsRound,setTimeout(()=>this.respawnAsteroids=!1,12e3);break;case rounds.boss:this.level+=1,this.respawnAsteroids=!0,this.round=rounds.asteroids,this.state=gameStates.asteroidsRound,this.level>1&&(this.powerUp=new PowerUp(powerUpTypes.shield)),setTimeout(()=>this.respawnAsteroids=!1,12e3);break;case rounds.asteroids:this.round=rounds.enemyShips,this.state=gameStates.enemyShipRound,this.level>1&&(this.powerUp=new PowerUp(powerUpTypes.wideShot));break;case rounds.obstacles:this.round=rounds.boss,this.state=gameStates.bossRound,this.powerUp=new PowerUp(powerUpTypes.longShot);break;case rounds.enemyShips:this.round=rounds.obstacles,this.state=gameStates.obstacleRound,this.obstacles=new ObstacleLevel(getPattern(this.currentGapPattern));break}intervals.game=setInterval(this.runGame,1e3/140),intervals.enemies=setInterval(this.runEnemies,1e3/this.gameSpeed),clearInterval(intervals.background),intervals.background=setInterval(game.moveBackground,1e3/140),this.round!==rounds.boss&&!this.musicRunning&&(this.music&&this.music.pause(),this.music=this.level===2?sounds.gameMusic3:sounds.gameMusic2,this.music.playbackRate=1,playSound(this.music),this.musicRunning=!0),this.round===rounds.boss&&(this.music.pause(),this.music=sounds.gameMusic,playSound(this.music),this.musicRunning=!1,playSound(sounds.bossAlert),this.level===4&&(intervals.bossPositionSwapping=setInterval(()=>this.boss2.swapPositions(),3e3)))}endLevel(){this.player.resetShots(),clearInterval(intervals.enemies),clearInterval(intervals.game),setTimeout(()=>{this.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>this.moveShipForAnimation(),1e3/120),playSound(sounds.spaceshipSound),this.gameSpeed<100&&(this.gameSpeed+=2),canvasContext.fillStyle="limegreen",canvasContext.fillText("Next round!",100,canvas.height/2)},500)}runEnemies=()=>{switch(this.powerUp&&(this.powerUp.move(),this.powerUp.detectCollisionWithPlayer()),this.round){case rounds.asteroids:this.runAsteroidsLevel();break;case rounds.enemyShips:this.runEnemyShipsLevel();break;case rounds.obstacles:this.runObstaclesLevel();break;case rounds.boss:this.runBossLevel();break;default:break}};runAsteroidsLevel(){this.activeAsteroids.forEach(e=>{e.moveAsteroid(),e.detectCollisionWithShip(),this.player.activeShots.forEach(t=>e.detectCollisionWithShot(t))}),this.activeAsteroids.length===0&&this.endLevel()}runEnemyShipsLevel(){this.moveShipEnemies(),this.enemyShips.forEach(e=>e.handleShots())}runObstaclesLevel(){this.obstacles.update(),this.obstacles.isOver()&&(this.score+=100,this.currentGapPattern+=1,this.endLevel())}runBossLevel(){if(this.level===3){this.boss.isActive||setTimeout(()=>this.boss.activate(),3e3),this.boss.move(),this.boss.moveObstacles(),this.boss.handleShots(),this.boss.elements.forEach(t=>this.player.activeShots.forEach(s=>t.hitDetection(s))),this.boss.obstacles&&this.boss.obstacles.forEach(t=>{t.detectCollisionWithShip(),this.player.activeShots.forEach(s=>t.hitDetection(s))});const e=this.boss.elements.find(t=>t.isHead);e.lives<=0&&(e.shots=[],e.setActiveShots(),this.boss.elements.forEach((t,s)=>{setTimeout(()=>{playSound(sounds.explosion),t.lives=.5},s*60)}),game.score+=500,this.endLevel())}else if(this.level===2){this.dualSnakes.some(s=>s.isActive)||setTimeout(()=>{this.dualSnakes.forEach(s=>s.activate())},3e3),this.dualSnakes.forEach(s=>{s.move(),s.detectHitByPlayer()});const e=this.dualSnakes[0].isDead(),t=this.dualSnakes[1].isDead();e&&(this.dualSnakes[0].runDeathAnimation(),this.dualSnakes[0].activeShots=[]),t&&(this.dualSnakes[1].runDeathAnimation(),this.dualSnakes[1].activeShots=[]),e&&t&&(game.score+=250,this.endLevel())}else this.level===4?(this.boss2.isActive||setTimeout(()=>this.boss2.activate(),3e3),this.boss2.detectHitByPlayer(),this.boss2.handleShots(),this.boss2.elements.some(e=>e.isHead&&e.lives>0)||(this.boss2.runDeathAnimation(),this.music.playbackRate=.5,setTimeout(()=>{this.music.pause()},2e3),this.gameWon||(this.score+=1e3,clearInterval(intervals.game),clearInterval(intervals.bossPositionSwapping),clearInterval(intervals.background),setTimeout(()=>{this.music.pause(),this.round=null,this.player.losePowerUps(),clearInterval(intervals.enemies),this.musicRunning=!1,this.isHighScore=!1,this.gameSpeed=60,playSound(sounds.credits),this.state=gameStates.credits},3e3)),this.gameWon=!0)):(this.snake.isActive||setTimeout(()=>this.snake.activate(),3e3),this.snake.move(),this.snake.detectHitByPlayer(),this.snake.isDead()&&(this.snake.runDeathAnimation(),game.score+=150,this.endLevel()))}moveShipEnemies(){const e=this.enemyShips.filter(t=>t.lives>0);e.forEach(t=>{t.moveShip(),this.player.activeShots.forEach(s=>t.detectHitByPlayer(s))}),e.length===1&&e.forEach(t=>t.moveDown()),e.length<1&&this.endLevel()}setScore(){this.score>this.highScore&&(this.highScore=this.score,this.isHighScore=!0)}switchInfoScreen(){this.state!==gameStates.titleScreen||!this.highScoresLoaded||(setTimeout(()=>this.switchInfoScreen(),5e3),this.displayedScreen===screens.title?this.displayedScreen=screens.highScores:this.displayedScreen=screens.title)}drawStartScreen(){if(canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),canvasContext.textAlign="center",canvasContext.fillStyle="limegreen",!this.highScoresLoaded&&!this.highScoresLoading){this.fetchHighScores();return}this.displayedScreen===screens.title&&this.drawTitleScreen(),this.displayedScreen===screens.highScores&&this.drawHighScores()}drawTitleScreen(){const s=(performance.now()-this.blinkingTextStartTime)%(2*800)<800;canvasContext.drawImage(images.background,0,this.animationBackgroundScrollPosition),s&&(canvasContext.fillText(this.gameLoaded<100?`Loading: ${this.gameLoaded}%`:"Press S to start",canvas.width/2,canvas.height/2),canvasContext.fillText(this.gameLoaded<100?this.loadingAnimation:"",canvas.width/2,canvas.height/2)),canvasContext.save(),canvasContext.font="12px retro",canvasContext.textAlign="right",canvasContext.fillText(`version ${versionNumber}`,canvas.width-10,canvas.height-10),canvasContext.restore(),canvasContext.save(),canvasContext.fillStyle="limegreen",canvasContext.font="48px retro",canvasContext.textAlign="center",canvasContext.strokeStyle="yellow",canvasContext.lineWidth=1,canvasContext.fillText("SPACE",canvas.width/2,canvas.height/2-140),canvasContext.strokeText("SPACE",canvas.width/2,canvas.height/2-140),canvasContext.fillText("FORCE",canvas.width/2,canvas.height/2-100),canvasContext.strokeText("FORCE",canvas.width/2,canvas.height/2-100),canvasContext.restore(),this.drawLoadingAnimation()}drawHighScores(){if(canvasContext.fillText("HighScores",canvas.width/2,70),!this.highScores||this.highScores.length<=1)canvasContext.textAlign="left",canvasContext.fillText("Loading...",20,190);else for(let e=0;e<8;e++)canvasContext.textAlign="left",canvasContext.fillText(e+1+" "+this.highScores[e].Player,20,e*50+140),canvasContext.textAlign="right",canvasContext.fillText(this.highScores[e].Score,canvas.width-20,e*50+140)}drawLoadingAnimation(){this.loadingAnimation.length<3&&(this.loadingAnimation+="."),this.loadingAnimation.length>=3&&(this.loadingAnimation="")}drawGameOverScreen(){canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),canvasContext.fillStyle="limegreen",canvasContext.textAlign="center",canvasContext.fillText("Game over",canvas.width/2,canvas.height/2-100),canvasContext.fillText("Score: "+this.score,canvas.width/2,canvas.height/2-50),nameInput.style.display="block",nameInput.focus(),this.isHighScore&&canvasContext.fillText("New HighScore",canvas.width/2,100)}drawCreditsScreen(){const e=["","","","","MISSION COMPLETE","You saved Earth!","","","GAME CREDITS","","","a game by","Christian Eckardt","","","Music by","sawsquarenoise","","","Special Thanks to","All Players","","","Final Score",`${this.score}`,"","","Thank you","for playing!"];canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),this.creditsStartTime||(this.creditsStartTime=performance.now());const t=(performance.now()-this.creditsStartTime)/1e3,s=50,h=canvas.height+50;canvasContext.font="24px retro",canvasContext.fillStyle="limegreen",canvasContext.textAlign="center",e.forEach((a,r)=>{const l=h-t*s+r*40;l>-30&&l<canvas.height+30&&(a==="CONGRATULATIONS!"||a==="GAME CREDITS"?(canvasContext.font="32px retro",canvasContext.fillText(a,canvas.width/2,l),canvasContext.font="24px retro"):a===`${this.score}`?canvasContext.fillText(this.score.toString(),canvas.width/2,l):canvasContext.fillText(a,canvas.width/2,l))});const o=e.length*40;(t*s>h+o+50||buttonsPressed.w)&&(this.state=gameStates.gameOver)}drawShipAndShot(){this.player.activeShots.length>0&&this.player.activeShots.forEach(e=>{e.draw()}),this.player.draw()}drawScore(){canvasContext.textAlign="start",canvasContext.fillStyle="limegreen",canvasContext.fillText("Score",12,30),canvasContext.fillStyle="white",canvasContext.fillText(this.score,12,55),canvasContext.textAlign="right",canvasContext.fillStyle="limegreen",canvasContext.fillText("Hi-Score",canvas.width-12,30),canvasContext.fillStyle="white",canvasContext.fillText(this.highScore,canvas.width-12,55),canvasContext.textAlign="center",canvasContext.fillStyle="limegreen",canvasContext.fillText("LVL",canvas.width/2-25,30),canvasContext.fillStyle="white",canvasContext.fillText(`${this.getLevelByRound()}`,canvas.width/2-25,55)}drawSpaceshipAnimation(){this.score===0?canvasContext.drawImage(images.background,0,this.animationBackgroundScrollPosition):(canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height)),canvasContext.fillStyle="limegreen",canvasContext.textAlign="center",canvasContext.fillText(this.score===0?"Save earth!":"Next round!",canvas.width/2,canvas.height/2),canvasContext.drawImage(images.playerShip,this.player.x,this.player.y,this.player.width,this.player.height),this.player.hasShield&&this.player.drawShield()}moveShipForAnimation(){this.player.y-=4,this.animationBackgroundScrollPosition<80&&(this.animationBackgroundScrollPosition+=2),this.player.y<-50&&(clearInterval(intervals.spaceShipAnimation),this.startNextRound())}drawEverything=()=>{switch(canvasContext.fillStyle="black",canvasContext.fillRect(0,0,canvas.width,canvas.height),this.backgroundScrollPositions.forEach(e=>{e&&canvasContext.drawImage(images.backgroundLoop1,0,e)}),this.drawShipAndShot(),this.drawScore(),this.state){case gameStates.asteroidsRound:this.activeAsteroids.forEach(e=>e.drawAsteroid()),this.powerUp&&this.powerUp.draw();break;case gameStates.enemyShipRound:this.enemyShips.forEach(e=>{e.draw()}),this.powerUp&&this.powerUp.draw();break;case gameStates.obstacleRound:this.obstacles.draw();break;case gameStates.bossRound:this.powerUp&&this.powerUp.draw(),this.level===3?this.boss.draw():this.level===2?this.dualSnakes.forEach(e=>e.draw()):this.level===4?this.boss2.draw():this.snake.draw();break;default:break}switch(this.drawScore(),this.state){case gameStates.titleScreen:this.drawStartScreen();break;case gameStates.spaceshipAnimation:this.drawSpaceshipAnimation();break;case gameStates.gameOver:this.drawGameOverScreen();break;case gameStates.credits:this.drawCreditsScreen();break;default:break}requestAnimationFrame(this.drawEverything)};moveBackground=()=>{this.backgroundScrollPositions.forEach((e,t)=>{e<2200?this.backgroundScrollPositions[t]+=1:this.backgroundScrollPositions[t]=-2200})};setVolume(e){this.volume=e===0?0:e*2/10,sessionStorage.setItem("volume",e),Array.from(document.getElementsByClassName("volume-item")).forEach(s=>{s.innerHTML=s.dataset.value>e?"&#9645;":"&#11036;"});for(let s in sounds)sounds[s]instanceof Audio&&(sounds[s].volume=this.volume)}fetchHighScores(){this.highScoresLoading=!0,fetch("https://shooter-backend-vercel.vercel.app/api/getHighscores").then(e=>e.json()).then(e=>this.highScores=e).then(()=>{this.highScore=this.highScores[0]?.Score||1e3,this.highScoresLoaded=!0,this.highScoresLoading=!1,setTimeout(()=>this.switchInfoScreen(),3e3)}).catch(()=>this.highScoresLoaded=!0)}postHighScore(e){e.preventDefault();let t=nameInput.value;t.length===0&&(t="Player");const s={Player:t,Score:game.score};fetch("https://shooter-backend-vercel.vercel.app/api/postHighscore",{method:"post",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(s)}).then(h=>h.json()).catch(h=>console.log(h)),nameInput.value="",buttonsPressed.s=!1,nameInput.style.display="none",this.highScoresLoaded=!1,this.fetchHighScores(),this.state=gameStates.titleScreen,this.round=null,this.resetGame()}addAsteroids(){this.asteroids.push(new Asteroid(100,-50,30,2.5),new Asteroid(200,-100,40,2.8),new Asteroid(300,-200,60,2.6),new Asteroid(150,-300,80,2.6),new Asteroid(50,-150,30,3.2),new Asteroid(250,-400,100,2.4),new Asteroid(0,-400,80,3.6))}resetAsteroids(){this.asteroids.length=0,this.addAsteroids(),this.setActiveAsteroids()}setActiveAsteroids(){this.activeAsteroids=this.asteroids.filter(e=>!e.hit)}addSnakeElements(){return[new SnakeElement(0,-40,!0),new SnakeElement(40,-40,!1),new SnakeElement(80,-40,!1),new SnakeElement(120,-40,!1),new SnakeElement(160,-40,!1),new SnakeElement(200,-40,!1),new SnakeElement(240,-40,!1),new SnakeElement(280,-40,!1)]}addDualSnakes(){return{snake1:[new SnakeElement(0,-40,!0),new SnakeElement(40,-40,!1),new SnakeElement(80,-40,!1),new SnakeElement(120,-40,!1),new SnakeElement(160,-40,!1)],snake2:[new SnakeElement(canvas.width-160,-80,!0),new SnakeElement(canvas.width-120,-80,!1),new SnakeElement(canvas.width-80,-80,!1),new SnakeElement(canvas.width-40,-80,!1),new SnakeElement(canvas.width,-80,!1)]}}}const game=new Game;function setVolume(i){game.setVolume(i)}class Asteroid{constructor(e,t,s,h){this.x=e,this.y=t,this.width=s,this.height=s,this.hit=!1,this.countBlocker=!1,this.speed=h}moveAsteroid(){this.hit||(game.score<400?this.y+=this.speed:game.score<800?this.y+=this.speed+.2:game.score<1200?this.y+=this.speed+.6:this.y+=this.speed+1,this.y>canvas.height&&(this.hit=!0,game.setActiveAsteroids(),game.respawnAsteroids&&this.addNewAsteroid()))}drawAsteroid(){this.hit||canvasContext.drawImage(this.countBlocker?images.explosion:images.asteroid,this.x,this.y,this.width,this.height)}addNewAsteroid(){const s=canvas.width-this.width,h=0,o=-(Math.random()*250)-100,n=Math.random()*(s-h)+h;game.respawnAsteroids&&game.asteroids.push(new Asteroid(n,o,this.width,this.speed)),game.setActiveAsteroids()}detectCollisionWithShip(){if(this.hit||this.countBlocker)return;const e=6,t=game.player.x+e<this.x+this.width&&game.player.x+game.player.width-e>this.x,s=game.player.y+e<this.y+this.height&&game.player.y+game.player.height-e>this.y;t&&s&&(!game.player.hasShield&&game.player.isInvincible&&(this.countBlocker=!0,setTimeout(()=>{this.hit=!0,game.setActiveAsteroids()},100)),game.player.hasShield?(game.player.losePowerUps(),this.countBlocker=!0,setTimeout(()=>{this.hit=!0,game.setActiveAsteroids()},100),setTimeout(()=>{game.player.hasShield||(game.player.isInvincible=!1)},500)):game.player.isInvincible||game.handleGameOver())}detectCollisionWithShot(e){const t=e.x<this.x+this.width&&e.x+e.width>this.x,s=e.y<this.y+this.height&&e.y+e.currentHeight>this.y;t&&s&&(this.countBlocker||(e.isActive=!1,game.player.setActiveShots(),playSound(sounds.hitSound),game.score+=5),this.countBlocker=!0,setTimeout(()=>{this.hit=!0,game.setActiveAsteroids(),this.addNewAsteroid()},100))}}class EnemyShip{constructor(e,t,s){this.x=e,this.y=t,this.width=60,this.height=60,this.speed=this.isLockOn?3:4,this.lives=game.level>1?4:2,this.isShotCoolDown=!1,this.shotCoolDown=400,this.shots=[],this.activeShots=[],this.isLockOn=game.level>1?s:!1,this.isLockOnMode=!1}draw(){this.lives>=1&&canvasContext.drawImage(images.enemyShip,this.x,this.y,this.width,this.height),this.lives%1!==0&&canvasContext.drawImage(images.explosion,this.x,this.y,this.width,this.height),!game.player.killed&&this.activeShots.forEach(e=>{e.draw()})}shoot(){this.isShotCoolDown||game.player.killed||(this.x+60>=game.player.x&&this.x<=game.player.x+60&&this.lives>=1&&(this.shots.push(new EnemyShot(this)),this.setActiveShots(),playSound(sounds.laserEnemy)),this.isShotCoolDown=!0,setTimeout(()=>this.isShotCoolDown=!1,this.shotCoolDown))}setActiveShots(){this.activeShots=this.shots.filter(e=>e.isActive)}moveShip(){!this.isLockOnMode&&this.isLockOn&&(this.isLockOnMode=!0,setTimeout(()=>this.isLockOnMode=!1,1e3)),this.isLockOnMode?(this.x<game.player.x&&(this.x+=Math.abs(this.speed)),this.x>game.player.x&&(this.x-=Math.abs(this.speed))):this.x+=this.speed,(this.x<=0||this.x>=canvas.width-40)&&(this.speed=-this.speed)}moveDown(){this.y<canvas.height-200&&(this.y+=1)}handleShots(){game.player.killed||(this.shoot(),this.activeShots.forEach(e=>{e.move(),e.detectHittingPlayer()}))}detectHitByPlayer(e){if(this.lives<=0)return;const t=e.y<this.y+this.height&&e.y+e.currentHeight>this.y,s=e.x<this.x+this.width&&e.x+e.width>this.x;t&&s&&this.lives>=1&&e.isActive&&(this.lives-=.5,playSound(this.lives<=.5?sounds.explosion2:sounds.hitSound),setTimeout(()=>this.lives-=.5,100),e.isActive=!1,game.player.setActiveShots(),game.score+=30)}}class EnemyShot{constructor(e){this.enemyShip=e,this.maxHeightShot=20,this.currentShotHeight=0,this.x=e.x,this.x2=e.x+30,this.y=e.y+10,this.isActive=!0,this.shotSpeed=4,this.shotWidth=10}draw(){this.isActive&&(this.currentShotHeight<this.maxHeightShot&&(this.currentShotHeight+=2),canvasContext.fillStyle="rgba(255,0,0,0.6)",canvasContext.fillRect(this.x,this.y,this.shotWidth,this.currentShotHeight),canvasContext.fillRect(this.x2,this.y,this.shotWidth,this.currentShotHeight),canvasContext.drawImage(images.enemyShot,this.x,this.y,this.shotWidth,this.currentShotHeight),canvasContext.drawImage(images.enemyShot,this.x2,this.y,this.shotWidth,this.currentShotHeight))}move(){this.isActive&&(this.y+=this.shotSpeed),this.y>canvas.height&&(this.isActive=!1,this.enemyShip.setActiveShots()),this.detectHittingPlayer()}detectHittingPlayer(){if(!this.isActive)return;const e=10,t=game.player.x+10+e<this.x+30&&game.player.x+80-10-e>this.x+20,s=game.player.x+10+e<this.x2+30&&game.player.x+80-10-e>this.x2+20,h=game.player.y+e<this.y+30&&game.player.y+10-e>this.y;(t||s)&&h&&this.enemyShip.lives>=1&&(game.player.hasShield?(game.player.losePowerUps(),this.currentShotHeight=0,this.isActive=!1,this.enemyShip.setActiveShots(),setTimeout(()=>{game.player.hasShield||(game.player.isInvincible=!1)},500)):game.player.isInvincible||game.handleGameOver())}}class Snake{constructor(e,t){this.elements=e,this.color=t,this.isActive=!1,this.blinkingTextStartTime=performance.now()}activate(){this.isActive=!0,this.elements.forEach(e=>e.isActive=!0)}move(){this.isActive&&this.elements.forEach(e=>{e.move(),e.handleShots()})}draw(){this.isActive?this.elements.forEach(e=>e.draw()):(performance.now()-this.blinkingTextStartTime)%(2*550)<550&&drawBossWarning(this.blinkingTextStartTime)}detectHitByPlayer(){this.elements.forEach(e=>{game.player.activeShots.forEach(t=>e.hitDetection(t))})}isDead(){return this.elements.find(e=>e.isHead).lives===0}runDeathAnimation(){this.elements.forEach((e,t)=>{e.isActive&&(e.shots=[],e.setActiveShots(),setTimeout(()=>{playSound(sounds.explosion),e.lives=.5,t===this.elements.length-1&&this.elements.forEach(s=>{s.lives=0,s.isActive=!1})},t*60))})}}class SnakeElement{constructor(e,t,s,h){this.isHead=s,this.x=e,this.y=t,this.size=40,this.speed=8,this.lives=s?4:1,this.image=s?images.snakeHead:images.snakeBody,this.isShotCoolDown=!1,this.shotCoolDown=750,this.shots=[],this.activeShots=[],this.regenerates=h,this.isActive=!1}draw(){if(canvasContext.fillStyle="#80008055",this.lives===0&&this.isActive){canvasContext.fillRect(this.x,this.y+this.size/2-4,this.size,8);return}canvasContext.filter=`hue-rotate(${game.colorVariable}deg)`,this.lives>.5&&canvasContext.drawImage(this.regenerates?images.bossStructure:this.image,this.x,this.y,this.size,this.size),this.lives%1!==0&&this.isActive&&canvasContext.drawImage(images.explosion,this.x,this.y,this.size,this.size),canvasContext.filter="none",!game.player.killed&&this.isHead&&this.activeShots.forEach(e=>{e.draw()})}move(){this.isActive&&(this.x-=this.speed,(this.x<-50||this.x>400)&&(this.y+=40,this.speed=-this.speed),this.lives>.5&&this.y>=450&&this.x<canvas.width-20&&game.handleGameOver())}moveAsBoss(){this.x-=this.speed/4,(this.x<=-120||this.x>canvas.width+120)&&(this.speed=-this.speed,this.y+=5)}shoot(){!this.isHead||!this.isActive||this.isShotCoolDown||this.x<0||this.y<0||this.x>canvas.width-this.size||this.lives===0||(this.isShotCoolDown=!0,this.shots.push(new EnemyShot(this)),playSound(sounds.laserEnemy),this.setActiveShots(),setTimeout(()=>this.isShotCoolDown=!1,this.shotCoolDown))}setActiveShots(){this.activeShots=this.shots.filter(e=>e.isActive)}handleShots(){game.player.killed||!this.isHead||this.lives===0||(this.shoot(),this.activeShots.forEach(e=>{e.move(),e.detectHittingPlayer()}))}hitDetection(e){if(this.y<0)return;const t=e.y<this.y+this.size&&e.y+e.currentHeight>this.y,s=e.x<this.x+this.size&&e.x+e.width>this.x;t&&s&&this.lives>.5&&(e.isActive=!1,game.player.setActiveShots(),game.colorVariable+=50,this.lives-=.5,setTimeout(()=>{this.lives-=.5,this.regenerates||(game.score+=10),this.lives===0&&this.regenerates&&setTimeout(()=>this.lives=1,1e3)},100),setTimeout(()=>{game.colorVariable-=50},50),playSound(this.isHead?sounds.bossHitSound:sounds.hitSound))}changePosition(e,t){this.x=e,this.y=t}}function drawBossWarning(i){(performance.now()-i)%(2*550)<550&&(canvasContext.save(),canvasContext.fillStyle="red",canvasContext.font="32px retro",canvasContext.textAlign="center",canvasContext.fillText("BOSS",canvas.width/2,canvas.height/2-20),canvasContext.fillText("APPROACHES",canvas.width/2,canvas.height/2+20),canvasContext.restore())}class Boss2{constructor(){this.elements=[new SnakeElement(0,80,!1,!0),new SnakeElement(40,80,!1,!0),new SnakeElement(80,80,!1,!0),new SnakeElement(120,80,!1,!0),new SnakeElement(160,80,!1,!0),new SnakeElement(200,80,!1,!0),new SnakeElement(240,80,!1,!0),new SnakeElement(280,80,!1,!0),new SnakeElement(320,80,!1,!0),new SnakeElement(360,80,!1,!0),new SnakeElement(0,120,!1,!0),new SnakeElement(80,120,!1,!0),new SnakeElement(160,120,!1,!0),new SnakeElement(200,120,!1,!0),new SnakeElement(280,120,!1,!0),new SnakeElement(360,120,!1,!0),new SnakeElement(0,160,!1,!0),new SnakeElement(40,160,!1,!0),new SnakeElement(80,160,!1,!0),new SnakeElement(120,160,!1,!0),new SnakeElement(160,160,!1,!0),new SnakeElement(200,160,!1,!0),new SnakeElement(240,160,!1,!0),new SnakeElement(280,160,!1,!0),new SnakeElement(320,160,!1,!0),new SnakeElement(360,160,!1,!0),new SnakeElement(40,120,!0,!1),new SnakeElement(120,120,!0,!1),new SnakeElement(240,120,!0,!1),new SnakeElement(320,120,!0,!1)],this.isActive=!1,this.blinkingTextStartTime=performance.now(),this.isDead=!1}draw(){this.elements.forEach(h=>h.draw()),(performance.now()-this.blinkingTextStartTime)%(2*550)<550&&!this.isActive&&drawBossWarning(this.blinkingTextStartTime)}activate(){this.isActive=!0,this.elements.forEach(e=>e.isActive=!0)}handleShots(){this.isDead||this.elements.forEach(e=>e.handleShots())}detectHitByPlayer(){this.elements.forEach(e=>{game.player.activeShots.forEach(t=>e.hitDetection(t))})}swapPositions(){if(!this.isActive)return;const e=[],t=[];this.elements.forEach((s,h)=>{s.isHead&&s.lives>0?e.push(h):!s.isHead&&s.lives>0&&t.push(h)}),!(e.length===0||t.length===0)&&(e.forEach(s=>{const h=t[Math.floor(Math.random()*t.length)],o=this.elements[s].x,n=this.elements[s].y,a=this.elements[h].x,r=this.elements[h].y;this.elements[s].changePosition(a,r),this.elements[h].changePosition(o,n)}),playSound(sounds.teleport))}runDeathAnimation(){this.isDead||(this.isDead=!0,this.elements.forEach((e,t)=>{e.shots=[],e.setActiveShots(),e.regenerates=!1,setTimeout(()=>{playSound(sounds.explosion),e.lives=.5,t===this.elements.length-1&&this.elements.forEach(s=>{s.lives=0,s.isActive=!1})},t*60)}))}}class Boss{constructor(){this.elements=[new SnakeElement(canvas.width,60,!1,!0),new SnakeElement(canvas.width+40,60,!1,!0),new SnakeElement(canvas.width+80,60,!1,!0),new SnakeElement(canvas.width,100,!1,!0),new SnakeElement(canvas.width+80,100,!1,!0),new SnakeElement(canvas.width,140,!1,!0),new SnakeElement(canvas.width+40,140,!1,!0),new SnakeElement(canvas.width+80,140,!1,!0),new SnakeElement(canvas.width+40,100,!0,!1)],this.obstacles=null,this.moves=!0,this.bossPosition="canvas",this.isActive=!1,this.blinkingTextStartTime=performance.now()}draw(){this.elements.forEach(h=>h.draw()),this.obstacles&&this.obstacles.forEach(h=>h.draw()),(performance.now()-this.blinkingTextStartTime)%(2*550)<550&&!this.isActive&&drawBossWarning(this.blinkingTextStartTime)}activate(){this.isActive=!0,this.elements.forEach(e=>e.isActive=!0)}handleShots(){this.elements.forEach(e=>e.handleShots())}move(){if(!this.isActive||!this.moves&&this.obstacles!==null)return;this.elements.forEach(s=>s.moveAsBoss());const e=!this.elements.some(s=>s.x>-50),t=!this.elements.some(s=>s.x<canvas.width+10);this.bossPosition!=="right-outbound"&&t?(this.bossPosition="right-outbound",this.moves=!1,this.setObstacles()):this.bossPosition!=="left-outbound"&&e&&(this.bossPosition="left-outbound",this.moves=!1,this.setObstacles())}setObstacles(){const e=Math.floor(Math.random()*9);this.obstacles=[[new Obstacle(0,-40,!0),new Obstacle(0,-80,!0),new Obstacle(0,-120,!0),new Obstacle(0,-160,!0)],[new Obstacle(40,-40,!0),new Obstacle(40,-80,!0),new Obstacle(40,-120,!0),new Obstacle(40,-160,!0)],[new Obstacle(80,-40,!0),new Obstacle(80,-80,!0),new Obstacle(80,-120,!0),new Obstacle(80,-160,!0)],[new Obstacle(120,-40,!0),new Obstacle(120,-80,!0),new Obstacle(120,-120,!0),new Obstacle(120,-160,!0)],[new Obstacle(160,-40,!0),new Obstacle(160,-80,!0),new Obstacle(160,-120,!0),new Obstacle(160,-160,!0)],[new Obstacle(200,-40,!0),new Obstacle(200,-80,!0),new Obstacle(200,-120,!0),new Obstacle(200,-160,!0)],[new Obstacle(240,-40,!0),new Obstacle(240,-80,!0),new Obstacle(240,-120,!0),new Obstacle(240,-160,!0)],[new Obstacle(280,-40,!0),new Obstacle(280,-80,!0),new Obstacle(280,-120,!0),new Obstacle(280,-160,!0)],[new Obstacle(320,-40,!0),new Obstacle(320,-80,!0),new Obstacle(320,-120,!0),new Obstacle(320,-160,!0)],[new Obstacle(360,-40,!0),new Obstacle(360,-80,!0),new Obstacle(360,-120,!0),new Obstacle(360,-160,!0)]],this.obstacles[e].forEach(t=>t.isActive=!1),this.obstacles[e+1].forEach(t=>t.isActive=!1),this.obstacles=this.obstacles.flat()}moveObstacles(){this.moves||(this.obstacles.forEach(e=>e.move()),this.obstacles.some(e=>e.y<canvas.height)||(this.moves=!0,this.obstacles=null))}}class Obstacle{constructor(e,t,s){this.x=e,this.y=t,this.isActive=s,this.speedY=4,this.size=canvas.width/10,this.lives=1}draw(){this.isActive&&(canvasContext.filter=`hue-rotate(${game.colorVariable}deg)`,this.lives>.5&&canvasContext.drawImage(images.bossStructure,this.x,this.y,this.size,this.size),this.lives%1!==0&&canvasContext.drawImage(images.explosion,this.x,this.y,this.size,this.size),canvasContext.filter="none")}move(){this.y+=this.speedY}hitDetection(e){if(!this.isActive)return;const t=e.y<this.y+this.size&&e.y+e.currentHeight>this.y,s=e.x<this.x+this.size&&e.x+e.width>this.x;t&&s&&this.lives>.5&&(e.isActive=!1,game.player.setActiveShots(),game.colorVariable+=50,this.lives-=.5,setTimeout(()=>{this.lives-=.5,this.isActive=!1},100),setTimeout(()=>{game.colorVariable-=50},50),playSound(sounds.hitSound))}detectCollisionWithShip(){if(!this.isActive)return;const e=6,t=game.player.x+e<this.x+this.size&&game.player.x+game.player.width-e>this.x,s=game.player.y+e<this.y+this.size&&game.player.y+game.player.height-e>this.y;if(t&&s){if(!game.player.hasShield&&game.player.isInvincible){this.isActive=!1;return}game.player.hasShield?(game.player.losePowerUps(),this.isActive=!1,setTimeout(()=>{game.player.hasShield||(game.player.isInvincible=!1)},500),game.player.isInvincible=!0):game.player.isInvincible||game.handleGameOver()}}}const getPattern=()=>gapPatterns[game.level-1],gapPattern=[[1,1,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,2,0,1],[1,1,1,1,0,0,0,0,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,2,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,1]],gapPattern2=[[1,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,2,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,2,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,2,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[1,1,1,1,1,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,1,1,1],[1,2,0,0,0,0,0,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,0,1]],gapPattern3=[[0,0,0,0,0,0,0,0,0,0],[1,0,0,0,1,1,0,0,0,1],[1,0,0,0,1,1,0,0,0,1],[1,0,0,0,1,1,0,2,0,1],[1,1,1,0,1,1,0,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,2,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,2,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[1,1,1,1,1,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,2,1,1,1],[1,0,0,0,0,0,0,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1]],gapPattern4=[[0,0,0,0,0,0,0,0,0,0],[1,0,1,1,1,1,0,0,0,1],[1,0,1,1,1,1,0,0,0,1],[1,0,1,1,1,1,0,0,0,1],[1,0,1,1,1,1,0,0,1,1],[1,2,1,0,0,0,0,0,0,1],[1,2,1,0,0,0,0,0,0,1],[1,2,1,0,0,0,0,0,0,1],[1,0,1,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,2,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,0,1,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,2,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,1,0,0,0,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,1,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,1],[1,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,0,0,0,1],[1,1,1,1,1,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,0,0,0,2,1,1,1],[1,0,0,0,0,0,0,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,0,0,0,1,1,1,1,1,1],[1,0,0,0,0,0,1,1,1,1],[1,1,0,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,0,0,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1]],gapPatterns=[gapPattern,gapPattern2,gapPattern3,gapPattern4];class Collectible{constructor(e,t){this.x=e,this.y=t,this.speedY=4,this.size=canvas.width/10,this.isCollected=!1}draw(){this.isCollected||canvasContext.drawImage(images.astronaut,this.x,this.y,this.size,this.size)}move(){this.y+=this.speedY}detectCollisionWithShip(){if(this.isCollected)return;const e=6,t=game.player.x+e<this.x+this.size&&game.player.x+game.player.width-e>this.x,s=game.player.y+e<this.y+this.size&&game.player.y+game.player.height-e>this.y;t&&s&&(this.isCollected=!0,game.score+=100,playSound(sounds.thankYou))}hitDetection(){}}class ObstacleLevel{constructor(e){this.pattern=e,this.currentRow=0,this.activeObstacles=[],this.obstacleSize=canvas.width/10,this.y=-80}update(){this.y-=this.obstacleSize,this.currentRow<this.pattern.length&&(this.pattern[this.currentRow].forEach((t,s)=>{t===1&&this.activeObstacles.push(new Obstacle(s*this.obstacleSize,this.y,!0)),t===2&&this.activeObstacles.push(new Collectible(s*this.obstacleSize,this.y))}),this.currentRow++),this.activeObstacles.forEach(e=>e.move()),this.activeObstacles=this.activeObstacles.filter(e=>e.y<canvas.height+40),this.handleCollisions()}handleCollisions(){this.activeObstacles.forEach(e=>e.detectCollisionWithShip()),game.player.activeShots.forEach(e=>{this.activeObstacles.forEach(t=>t.hitDetection(e))})}draw(){this.activeObstacles.forEach(e=>{e.y>=-20&&e.draw()})}isOver(){return!this.activeObstacles||!this.activeObstacles[this.activeObstacles.length-1]?!1:game.player.y+game.player.height<this.activeObstacles[this.activeObstacles.length-1].y}}const powerUpTypes={shield:"Shield power up",wideShot:"Wide shot power up",longShot:"Long shot power up"};function drawPowerUp(i,e,t,s){canvasContext.save(),canvasContext.beginPath();for(let r=0;r<20;r++){const d=r/20*Math.PI*2,l=(r+1)/20*Math.PI*2,c=i+t*Math.cos(d),u=e+t*Math.sin(d),p=i+t*Math.cos(l),f=e+t*Math.sin(l);canvasContext.lineTo(c,u),canvasContext.lineTo(p,f)}canvasContext.closePath(),canvasContext.strokeStyle="white",canvasContext.lineWidth=3,canvasContext.stroke(),canvasContext.beginPath(),canvasContext.arc(i,e,t-3,0,Math.PI*2);const o=canvasContext.createRadialGradient(i,e,0,i,e,t),n=getGradientByType(s);o.addColorStop(0,n.step1),o.addColorStop(1,n.step2),canvasContext.fillStyle=o,canvasContext.fill();const a=s.at(0);canvasContext.font=`${t}px retro`,canvasContext.textAlign="center",canvasContext.textBaseline="middle",canvasContext.fillStyle="white",canvasContext.fillText(a,i,e),canvasContext.restore()}function getGradientByType(i){if(i===powerUpTypes.shield)return{step1:"rgba(0, 255, 155, 0.6)",step2:"rgba(0, 255, 0, 0.6)"};if(i===powerUpTypes.wideShot)return{step1:"rgba(255, 155, 0, 0.6)",step2:"rgba(255, 0, 0, 0.6)"};if(i===powerUpTypes.longShot)return{step1:"rgba(0, 0, 255, 0.6)",step2:"rgba(155, 0, 255, 0.6)"}}class PowerUp{constructor(e){this.type=e,this.maxX=canvas.width-20,this.minX=20,this.x=Math.random()*(this.maxX-this.minX)+this.minX,this.y=-800,this.baseRadius=20,this.radius=20,this.pulseTime=0,this.pulseSpeed=.07,this.pulseRange=3,this.speedX=3,this.speedY=3,this.isActive=!0}draw(){this.isActive&&(this.pulseTime+=this.pulseSpeed,this.radius=this.baseRadius+Math.sin(this.pulseTime)*this.pulseRange,drawPowerUp(this.x,this.y,this.radius,this.type))}move(){this.isActive&&(this.y+=this.speedY,this.x+=this.speedX,this.x+=this.speedX,this.x>canvas.width&&(this.speedX=-this.speedX),this.x<0&&(this.speedX=-this.speedX)),this.y>canvas.height&&(this.isActive=!1)}detectCollisionWithPlayer(){if(!this.isActive)return;const e=Math.max(game.player.x,Math.min(this.x,game.player.x+game.player.width)),t=Math.max(game.player.y,Math.min(this.y,game.player.y+game.player.height)),s=this.x-e,h=this.y-t;s*s+h*h<this.radius*this.radius&&(this.isActive=!1,this.type===powerUpTypes.shield&&(game.player.hasShield&&(game.score+=50),game.player.hasShield=!0,game.player.isInvincible=!0),this.type===powerUpTypes.wideShot&&(game.player.hasWideShot&&(game.score+=50),game.player.hasWideShot=!0),this.type===powerUpTypes.longShot&&(game.player.hasLongShot&&(game.score+=50),game.player.hasLongShot=!0),playSound(this.type===powerUpTypes.shield?sounds.shieldUp:sounds.powerUp))}}class Shot{constructor(e,t){this.isWideShot=e,this.isLongShot=t,this.width=this.isWideShot?20:10,this.fullHeight=this.isLongShot?100:20,this.currentHeight=0,this.x=game.player.x+game.player.width/2-this.width/2,this.y=game.player.y,this.isActive=!0,this.shotSpeed=6}move(){this.isActive&&(this.y-=this.shotSpeed),this.y<=-20&&(this.isActive=!1,game.player.setActiveShots()),this.currentHeight<this.fullHeight&&(this.currentHeight+=2)}draw(){!this.isWideShot&&!this.isLongShot&&canvasContext.drawImage(images.playerShot,this.x,this.y,this.width,this.fullHeight),this.isWideShot&&!this.isLongShot&&canvasContext.drawImage(images.wideShot,this.x,this.y,this.width,this.fullHeight),!this.isWideShot&&this.isLongShot&&canvasContext.drawImage(images.longShot,this.x,this.y,this.width,this.currentHeight),this.isWideShot&&this.isLongShot&&canvasContext.drawImage(images.wideAndLongShot,this.x,this.y,this.width,this.currentHeight)}playLaserSound(){let e;game.player.hasWideShot&&game.player.hasLongShot?e=sounds.laser3:game.player.hasWideShot||game.player.hasLongShot?e=sounds.laser2:e=sounds.laser,playSound(e)}}const buttonsPressed={a:!1,d:!1,w:!1,s:!1},touchControls={x:null,active:!1};function changeTouchPosition(i){touchControls.active=!0,touchControls.x=i.targetTouches?i.targetTouches[0].pageX-canvas.offsetLeft:i.offsetX,buttonsPressed.s||(buttonsPressed.s=!0,game.score=0,game.startGame(),game.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>game.moveShipForAnimation(),1e3/120),buttonsPressed.s=!0)}function keyDownHandler(i){i.key==="a"||i.key==="ArrowLeft"?buttonsPressed.a=!0:i.key==="d"||i.key==="ArrowRight"?buttonsPressed.d=!0:(i.key==="w"||i.key==="ArrowUp")&&(buttonsPressed.w=!0),i.key==="s"&&!buttonsPressed.s&&game.gameLoaded>=100&&(game.score=0,game.startGame(),game.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>game.moveShipForAnimation(),1e3/120),buttonsPressed.s=!0)}function keyUpHandler(i){i.key==="a"||i.key==="ArrowLeft"?buttonsPressed.a=!1:i.key==="d"||i.key==="ArrowRight"?buttonsPressed.d=!1:(i.key==="w"||i.key==="ArrowUp")&&(buttonsPressed.w=!1)}window.onload=()=>{game.fetchHighScores(),loadImages(),loadSounds();const i=sessionStorage.getItem("volume");i&&game.setVolume(parseFloat(i)),requestAnimationFrame(game.drawEverything),canvas.addEventListener("touchstart",changeTouchPosition,!1),canvas.addEventListener("touchmove",changeTouchPosition,!1),canvas.addEventListener("touchend",function(){touchControls.active=!1}),document.addEventListener("keydown",keyDownHandler,!1),document.addEventListener("keyup",keyUpHandler,!1),intervals.listenForStart=setInterval(()=>{navigator.getGamepads()[0]!==null&&!buttonsPressed.s&&navigator.getGamepads()[0].buttons[9].pressed&&(game.score=0,game.startGame(),game.state=gameStates.spaceshipAnimation,intervals.spaceShipAnimation=setInterval(()=>game.moveShipForAnimation(),1e3/120),buttonsPressed.s=!0)},1e3/30),document.getElementById("high-score-form").onsubmit=function(e){e.preventDefault(),game.postHighScore(e)}};
