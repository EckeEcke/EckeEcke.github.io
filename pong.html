<html>
<head>
<meta name="viewport" content="width=device-width, maximum-scale=1.0">
<title>Javascript Pong üèì</title>
<link rel="stylesheet" href="css/pong.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="icon" type="image/png" href="images/favicon.png"/>
<script type="text/javascript" src="script.js"></script>
</head>

<body>

  <a href="index.html" style="display: block">
    <img id="logo" src="images/logo.png">
  </a>  

<button onclick="soundControl()" id="sound-button">&#128263;</button>


  <audio src="sounds/bounce.wav" id="bounce"></audio>
  <audio src="sounds/cheer2.wav" id="cheer2"></audio>
  <audio src="sounds/cheer1.wav" id="cheer1"></audio>
  <audio src="sounds/bounce1.wav" id="bounce1"></audio>
  <audio src="sounds/victory.wav" id="victory"></audio>



<button id="hamburger" onclick="showMenu()">
  <div class="line1"></div>
  <div class="line2"></div>
  <div class="line3"></div>
</button>

<div id="burger-menu">
  <ul>
    <li>
      <a href="index.html">Home</a>
    </li>
    <hr class="nav-line">
    <li>
      <a href="https://nifty-hopper-c1da01.netlify.app/" target="_blank">React Travel Blog</a>
    </li>
    <hr class="nav-line">
    <li>
      <a href="shooter.html">JS Space Shooter</a>
    </li>
    <hr class="nav-line">
    <li>
      <a href="pong.html">JS Pong</a>
    </li>
    <hr class="nav-line">
    <li>
      <a href="jsdemos.html">Demos</a>
    </li>
  </ul>
</div>

<div class="black-box">

<div>
  <br><br>
  <center>
    <h2>Pong</h2>

    <br>


  <div class="scoreboard">

  <div id="Score1">
  <div id="P1Score"></div>
  </div>
  <div id="Score2">
  <div id="P2Score">
  </div>
  </div>

  </div>
  <br>





  </center>
</div>

<canvas id="game-canvas" width="800px" height="600px">
</canvas>
<br>
<article class="controls">
  Controls P1: "W" and "S"  |  Controls P2: "O" and "L"<br>

  <br><br>

  <button id="start-button" onclick="startGame()">
  &#127955; Start &#127955;
  </button>
  <br><br>
<div id="game-settings">
  <input type="color" id="color-picker-p1" value="#ed3d0d"><label>&nbsp Choose color P1</label>
  <br>
  <input type="color" id="color-picker-p2" value="#26ed17"><label>&nbsp Choose color P2</label>
  <br>
  <input type="range" id="game-speed" min="100" max="200" value="100"><label>&nbsp Set gamespeed &nbsp</label>
</div>




</article>

<article id="description">
  <br><br>
  To start with Javascript I took a Udemy course on how to build Pong using Javascript. I wrote functions drawing rectangles into a canvas element and making them move. The calculations recognize when the ball would leave the canvas and make it change direction (collision) or count the score. The score is also displayed in HTML. I implemented sounds that play if certain conditions are met. Also I built in a button to turn sound on or off.
</article>

<article class="too-small">
  <br>
  <br>
  <br>
  If you can read this, your screen is to small! You can play my version of Pong on your PC in full screen mode!
</article>
</div>


<script>

  const canvas = document.getElementById("game-canvas");
  const startBtn = document.getElementById("start-button");
  const soundBtn = document.getElementById("sound-button");
  const descriptionTxt = document.getElementById("description");

  const colorInputP1 = document.getElementById("color-picker-p1");
  const colorInputP2 = document.getElementById("color-picker-p2");
  const gameSpeedInput = document.getElementById("game-speed");

  const soundCheer1 = document.getElementById("cheer1");
  const soundCheer2 = document.getElementById("cheer2");
  const soundVictory = document.getElementById("victory");
  const inputs = document.getElementById("game-settings");

  let colorPaddle1 = "#ed3d0d";
  let colorPaddle2 = "#26ed17";

  let canvasContext;
  let ballX = 400;
  let ballSpeedX = 5;
  let ballY = 300;
  let ballSpeedY = 0;
  let paddle1Y = 250;
  let paddle2Y = 250;
  let upPressed = false;
  let downPressed = false;
  let wPressed = false;
  let sPressed = false;
  let Score1 = 0;
  let Score2 = 0;
  const paddleHeight = 100;
  const tolerance = 20;
  let speedBoost= 0;
  let hitCounter = 0;
  const sounds = document.getElementsByTagName("audio");
  let gameRuns = false;
  let gameSpeed = 100;

  sounds.muted = true;

  colorInputP1.addEventListener("change", function(){
    colorPaddle1 = colorInputP1.value;
  });

  colorInputP2.addEventListener("change", function(){
    colorPaddle2 = colorInputP2.value;
  });

  gameSpeedInput.addEventListener("change", function(){
    gameSpeed = gameSpeedInput.value;
  })

  window.onload = function () {
    document.addEventListener("keydown", keyDownHandler, false);
    document.addEventListener("keyup", keyUpHandler, false);
  }


  function startGame(){
    canvas.style.display ="block";
    canvasContext = canvas.getContext("2d");
    setInterval(callAll, 1000/gameSpeed);
    startBtn.style.display ="none";
    descriptionTxt.style.display = "none";
    inputs.style.display = "none";

  }



  function soundControl() {
    //document.getElementById("sound-button").style.display="none";
    if (sounds.muted == true){
      sounds.muted = false;
      soundBtn.innerHTML="&#128266;";
    } else {
      sounds.muted = true;
      soundBtn.innerHTML="&#128263;";
    }
    console.log(sounds);
  }

  function callAll() {
    drawEverything();
    moveEverything();
    moveDown1();
    collision2();
    collision1();
    moveUp1();
    moveDown2();
    moveUp2();
    P1Score();
    P2Score();
    countP1();
    countP2();
    raiseSpeed();
  }



  function moveEverything() {
    ballX = ballX + ballSpeedX;
    ballY = ballY + ballSpeedY;

    if (ballX == canvas.width) {
      ballSpeedX = ballSpeedX/ballSpeedX*(-1)*2;

    }
    if (ballX == 0) {
      ballSpeedX = ballSpeedX/ballSpeedX*2;
    }

    ballY = ballY + ballSpeedY;
    if (ballY >= canvas.height) {
      ballSpeedY = -ballSpeedY;
    }
    if (ballY <= 0) {
      ballSpeedY = -ballSpeedY;
    }

  }



  function moveUp1 (event) {
    if(wPressed) {
      paddle1Y = paddle1Y - 10;
    }
    if(paddle1Y < 0) {
      paddle1Y = 0;
    }
  }

  function moveDown1 (event) {
      if(sPressed) {
        paddle1Y = paddle1Y + 8;
      }
      if(paddle1Y > 500) {
        paddle1Y = 500;
      }

    }
  function moveDown2 (event) {
      if(downPressed) {
        paddle2Y = paddle2Y + 8;
      }
      if(paddle2Y > 500) {
        paddle2Y = 500;
      }

    }

    function moveUp2 (event) {
      if(upPressed) {
        paddle2Y = paddle2Y - 10;
      }
      if(paddle2Y < 0) {
        paddle2Y = 0;
      }
    }

function keyDownHandler (event) {
  if(event.keyCode === 87) {
    wPressed = true;
  }
  else if (event.keyCode === 83) {
    sPressed = true;
  }
  else if (event.keyCode === 79) {
    upPressed = true;
  }
  else if (event.keyCode === 76) {
    downPressed = true;
  }
}
  function keyUpHandler (event) {
    if(event.keyCode === 87) {
      wPressed = false;
    }
    else if (event.keyCode === 83) {
      sPressed = false;
    }
    else if (event.keyCode === 79) {
      upPressed = false;
    }
    else if (event.keyCode === 76) {
      downPressed = false;
    }
  }

  function P1Score () {
    if (ballX == canvas.width) {
      Score1 = Score1 +1;
      if (sounds.muted == false){
      soundCheer1.play();
      }
    }

    if (ballX == canvas.width) {
      ballX = 400;
      hitCounter = 0;
    }

    if (Score1 == 10) {
      if (sounds.muted == false){
      soundVictory.play();
      }
      alert("Player1 wins!");
      Score1 = 0;
      Score2 = 0;
      paddle1Y = 250;
      paddle2Y = 250;
    }
  }


  function countP1 () {
    document.getElementById("P1Score").innerHTML = Score1;
  }

  function P2Score () {
    if (ballX == 0) {
      Score2 = Score2 +1;
      if (sounds.muted == false){
      soundCheer2.play();
    }
    }

    if (ballX == 0) {
      ballX = 400;
      hitCounter = 0;
    }

    if (Score2 == 10) {
      if (sounds.muted == false){
      victorySound.play();
      }
      alert("Player2 wins!");
      Score1 = 0;
      Score2 = 0;
      paddle1Y = 250;
      paddle2Y = 250;
    }
  }

  function countP2 () {
    document.getElementById("P2Score").innerHTML = Score2;
  }

  function collision2 () {

    if (ballX == 760 && ballY >= paddle2Y + paddleHeight/4 && ballY <= paddle2Y + 3*paddleHeight/4 && ballY >=0) { /*middle paddle*/
      ballSpeedX = -5 - speedBoost;
      ballSpeedY = ballSpeedY -1;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce").play();
      }
    }
    if (ballX == 760 && ballY >= paddle2Y - tolerance && ballY < paddle2Y + paddleHeight/4 && ballSpeedY <= 0) { /*top paddle*/
      ballSpeedX = -5 - speedBoost;
      ballSpeedY = 2;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce").play();
      }
    }
    if (ballX == 760 && ballY > paddle2Y + 3*paddleHeight/4 && ballY < paddle2Y + paddleHeight+tolerance && ballSpeedY >= 0) { /*bottom paddle*/
      ballSpeedX = -5 - speedBoost;
      ballSpeedY = 2;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce").play();
      }
    }

    if (ballX == 760 && ballY >= paddle2Y + paddleHeight/4 && ballY <= paddle2Y + 3*paddleHeight/4 && ballSpeedY < 0) { /*middle paddle*/
      ballSpeedX = -5 - speedBoost;
      ballSpeedY = ballSpeedY + 1;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce").play();
      }
    }

    if (ballX == 760 && ballY >= paddle2Y - tolerance && ballY < paddle2Y + paddleHeight/4 && ballSpeedY > 0) { /*top paddle*/
      ballSpeedX = -5 - speedBoost;
      ballSpeedY = (-2);
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce").play();
      }
    }

    if (ballX == 760 && ballY > paddle2Y + 3*paddleHeight/4 && ballY < paddle2Y + paddleHeight+tolerance && ballSpeedY < 0) { /*bottom paddle*/
      ballSpeedX = -5 - speedBoost;
      ballSpeedY = 2;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce").play();
      }
    }
  }


  function collision1 () {

    if (ballX == 30 && ballY >= paddle1Y + paddleHeight/4 && ballY <= paddle1Y + 3*paddleHeight/4 && ballY >=0) { /*middle paddle*/
      ballSpeedX = 5 + speedBoost;
      ballSpeedY = ballSpeedY -1;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce1").play();
      }
    }

    if (ballX == 30 && ballY >= paddle1Y - tolerance && ballY < paddle1Y + paddleHeight/4 && ballSpeedY <= 0) {
      ballSpeedX = 5 + speedBoost;
      ballSpeedY = 2;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce1").play();
      }
    }

    if (ballX == 30 && ballY > paddle1Y + 3*paddleHeight/4 && ballY < paddle1Y + paddleHeight+tolerance && ballSpeedY >= 0) {
      ballSpeedX = 5 + speedBoost;
      ballSpeedY = 2;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce1").play();
      }
    }

    if (ballX == 30 && ballY >= paddle1Y + paddleHeight/4 && ballY <= paddle1Y + 3*paddleHeight/4 && ballSpeedY < 0) {
      ballSpeedX = 5 + speedBoost;
      ballSpeedY = ballSpeedY + 1;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce1").play();
      }
    }

    if (ballX == 30 && ballY >= paddle1Y - tolerance && ballY < paddle1Y + paddleHeight/4 && ballSpeedY > 0) {
      ballSpeedX = 5 + speedBoost;
      ballSpeedY = (-2);
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce1").play();
      }
    }

    if (ballX == 30 && ballY > paddle1Y + 3*paddleHeight/4 && ballY < paddle1Y + paddleHeight+tolerance && ballSpeedY < 0) {
      ballSpeedX = 5 + speedBoost;
      ballSpeedY = 2;
      hitCounter = hitCounter + 1;
      if (sounds.muted == false){
      document.getElementById("bounce1").play();
      }
    }

  }

  function raiseSpeed () {
    if (hitCounter >= 20) {
      speedBoost = 5;
    }
    else {
    speedBoost = 0;
  }
  }
  function drawEverything() {

    canvasContext.fillStyle = "black"; /*black background*/
    canvasContext.fillRect(0,0,canvas.width,canvas.height);
    canvasContext.fillStyle = "red"; /*middle line*/
    canvasContext.fillRect(canvas.width/2,0,1,canvas.height);
    canvasContext.fillStyle = "white"; /*ball*/
    canvasContext.fillRect(ballX,ballY,10,10);
    canvasContext.fillStyle = colorPaddle1;/*Paddle1*/
    canvasContext.fillRect(20,paddle1Y,10,paddleHeight);
    canvasContext.fillStyle = colorPaddle2; /*Paddle2*/
    canvasContext.fillRect(770,paddle2Y,10,paddleHeight);
  }




  function showMenu(){
    if (document.getElementById("burger-menu").style.display === "none") {
      document.getElementById("burger-menu").style.display = "block";
    }
    else {
      document.getElementById("burger-menu").style.display = "none";
    }
  }

</script>


</body>
</html>
